[{"path":"https://gaballench.github.io/tbea/articles/intro.html","id":"priors","dir":"Articles","previous_headings":"","what":"Priors","title":"Introduction to tbea","text":"Prior specification depends strongly trying use order calibrate given phylogeny. instance, node calibration tip calibration work different ways, prior specification depend also nature information trying use priors. common case, fossil taxon (occurrence) inform us age given node (node calibration). However, lack exact information two things: organism lived (measured without error), given diversification event took place (.e., exact age node). fossil, whose age inferred measured error uncertainty. information, uncertainty, expect model priors (lease done real life). prior probability density function (PDF hereafter), , mathematical function describing probability variable take given value inside given interval. less precise statements can made aid PDFs, likely variable X takes value values b rather c d; expected value variable interest. Now, age information following instances: fossil comes volcanic layer dated radiometric techniques specific value ±\\pm uncertainty, instance, 40.6 ±\\pm 0.5 Ma, 0.5 standard deviation σ\\sigma. fossil comes sedimentary unit said Miocene age (5.33 23.03 Ma). fossil comes layer bracketed two levels volcanic ash dated 10.2 ±\\pm 0.2 12.4 ±\\pm 0.4 respectively. , fossil age determined interpolated layers real age information. can convert information legitimate priors?","code":""},{"path":"https://gaballench.github.io/tbea/articles/intro.html","id":"the-findparams-function","dir":"Articles","previous_headings":"Priors","what":"The findParams function","title":"Introduction to tbea","text":"Given prior age fossil 1 - 10 Ma want model lognormal distribution, fin parameters PDF best reflect uncertainty question (.e., parameters observed quantiles 1, 5.5, 10, assuming want midpoint reflect mean PDF: Now published study specified lognormal prior (without justification, ’s another question) want actually plot outside beauti, instance, order assess similarity posterior prior. can plot R use data statistical density?","code":"tbea::findParams(q = c(1, 5.5, 10),           p = c(0.025,  0.50, 0.975),           output = \"complete\",           pdfunction = \"plnorm\",           params = c(\"meanlog\", \"sdlog\")) ## Warning in tbea::findParams(q = c(1, 5.5, 10), p = c(0.025, 0.5, 0.975), : ## initVals not provided, will use the mean of quantiles in q for _each_ of the ## parameters. Parameter estimates might not be reliable even though convergence ## is reported. ## Warning in plnorm(q = c(1, 5.5, 10), meanlog = 1.5962890625, sdlog = ## -1.83852539062498): NaNs produced ## Warning in plnorm(q = c(1, 5.5, 10), meanlog = 1.5962890625, sdlog = ## -1.83852539062498): NaNs produced ## Warning in plnorm(q = c(1, 5.5, 10), meanlog = 0.397998046874998, sdlog = ## -1.16190185546872): NaNs produced ## Warning in plnorm(q = c(1, 5.5, 10), meanlog = 0.840979003906248, sdlog = ## -0.149819946289039): NaNs produced ## Warning in plnorm(q = c(1, 5.5, 10), meanlog = 1.3444351196289, sdlog = ## -0.0238803863525183): NaNs produced ## Warning in plnorm(q = c(1, 5.5, 10), meanlog = 1.83548833280802, sdlog = ## -0.291388470306973): NaNs produced ## Warning in plnorm(q = c(1, 5.5, 10), meanlog = 1.86174815893173, sdlog = ## -0.0716773837804601): NaNs produced ## Warning in plnorm(q = c(1, 5.5, 10), meanlog = 1.7567301876843, sdlog = ## -0.09538053739814): NaNs produced ## $par ## [1] 1.704744 0.305104 ##  ## $value ## [1] 0.0006250003 ##  ## $counts ## function gradient  ##      101       NA  ##  ## $convergence ## [1] 0 ##  ## $message ## NULL"},{"path":"https://gaballench.github.io/tbea/articles/intro.html","id":"the-lognormalbeast-function","dir":"Articles","previous_headings":"Priors","what":"The lognormalBeast function","title":"Introduction to tbea","text":"Generate matrix lognormal density mean 1 standard deviation 1, mean real space, spanning values x 0 10, plot :","code":"lnvals <- tbea::lognormalBeast(M = 1, S = 1, meanInRealSpace = TRUE, from = 0, to = 10) plot(lnvals, type = \"l\", lwd = 3)"},{"path":"https://gaballench.github.io/tbea/articles/intro.html","id":"density-similarity","dir":"Articles","previous_headings":"","what":"Density similarity","title":"Introduction to tbea","text":"One hot topic model tool comparisons similarity posterior prior, , much results resemble de distribution set prior. instance, posterior identical prior, means likelihood (data) providing information, risky potential manipulate results Bayesian analyses.","code":""},{"path":"https://gaballench.github.io/tbea/articles/intro.html","id":"the-measuresimil-function","dir":"Articles","previous_headings":"Density similarity","what":"The measureSimil function","title":"Introduction to tbea","text":"Measure plot similarity two distributions partially overlapping: number legend indicates overlap 0.13, , measure similarity densities.","code":"set.seed(1985) colors <- c(\"red\", \"blue\", \"lightgray\") below <- tbea::measureSimil(d1 = rnorm(1000000, mean = 3, 1),                        d2 = rnorm(1000000, mean = 0, 1),                        main = \"Partial similarity\",                        colors = colors) legend(x = \"topright\", legend = round(below, digits = 2))"},{"path":"https://gaballench.github.io/tbea/articles/intro.html","id":"geochronology","dir":"Articles","previous_headings":"","what":"Geochronology","title":"Introduction to tbea","text":"third case possible age estimates calibrations, can clump together number age estimates several samples order build general uncertainty interval? age estimates boundaries Honda Group (.e., samples meters 56.4 675.0) conform isochron hypothesis? p-value smaller nominal alpha 0.05, can reject null hypothesis isochron conditions. age estimates samples JG-R 88-2 JG-R 89-2 conform isochron hypothesis? p-value larger nominal alpha 0.05, reject null hypothesis isochron conditions","code":"data(laventa) hondaIndex <- which(laventa$elevation == 56.4 | laventa$elevation == 675.0)  mswd.test(age = laventa$age[hondaIndex], sd = laventa$one_sigma[hondaIndex]) ## [1] 3.697832e-11 twoLevelsIndex <- which(laventa$sample == \"JG-R 89-2\" | laventa$sample == \"JG-R 88-2\") dataset <- laventa[twoLevelsIndex, ] # Remove the values 21 and 23 because of their abnormally large standard deviations tbea::mswd.test(age = dataset$age[c(-21, -23)], sd = dataset$one_sigma[c(-21, -23)]) ## [1] 0.993701"},{"path":"https://gaballench.github.io/tbea/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gustavo . Ballen. Author, maintainer. Sandra Reinales. Author.","code":""},{"path":"https://gaballench.github.io/tbea/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Ballen G, Reinales S (2025). tbea: Pre- Post-Processing Bayesian Evolutionary Analyses. R package version 1.7.0, https://github.com/gaballench/tbea.","code":"@Manual{,   title = {tbea: Pre- And Post-Processing in Bayesian Evolutionary Analyses},   author = {Gustavo A. Ballen and Sandra Reinales},   year = {2025},   note = {R package version 1.7.0},   url = {https://github.com/gaballench/tbea}, }"},{"path":[]},{"path":"https://gaballench.github.io/tbea/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Pre- And Post-Processing in Bayesian Evolutionary Analyses","text":"R package pre- post-processing phylogenetic Bayesian inference divergence times. Functions provided prior specification divergence time estimation using fossils well kinds data. provides tools interacting input output Bayesian platforms evolutionary biology ‘BEAST2’, ‘MrBayes’, ‘RevBayes’, ‘MCMCTree’. Implements simple measure similarity probability density functions comparing prior posterior Bayesian densities, well code calculating combination distributions using conflation Hill (2008). Functions estimating origination time collections distributions using x-intercept (e.g., Draper Smith, 1998) stratigraphic intervals (Marshall 2010) also available. Hill, T. 2008. “Conflations probability distributions”. Transactions American Mathematical Society, 363:3351-3372. doi:10.48550/arXiv.0808.1808 Draper, N. R. Smith, H. 1998. “Applied Regression Analysis”. 1–706. Wiley Interscience, New York. DOI:10.1002/9781118625590, Marshall, C. R. 2010. “Using confidence intervals quantify uncertainty end-points stratigraphic ranges”. Quantitative Methods Paleobiology, 291–316. DOI:10.1017/S1089332600001911.","code":""},{"path":"https://gaballench.github.io/tbea/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Pre- And Post-Processing in Bayesian Evolutionary Analyses","text":"can now install stable version CRAN, development one using remotes:","code":"install.packages(\"tbea\") remotes::install_github(\"gaballench/tbea\")"},{"path":"https://gaballench.github.io/tbea/index.html","id":"authorship-and-citation","dir":"","previous_headings":"","what":"Authorship and citation","title":"Pre- And Post-Processing in Bayesian Evolutionary Analyses","text":"package created maintained Gustavo . Ballen (@gaballench) Sandra Reinales (@spreinalesl). Please cite package follows: Ballen, G.. & Reinales, S. (2025). tbea: tools pre- post-processing Bayesian evolutionary analyses. Evolutionary Journal Linnean Society https://www.biorxiv.org/content/10.1101/2024.06.18.599561. use bibtex, use following entry .bib file:","code":"@article {Ballen2024.06.18.599561,     author = {Ballen, Gustavo A. and Reinales, Sandra},     title = {tbea: tools for pre- and post-processing in Bayesian evolutionary analyses},     year = {2025},     doi = {10.1101/2024.06.18.599561},     eprint = {https://www.biorxiv.org/content/early/2024/06/19/2024.06.18.599561.full.pdf},     journal = {Evolutionary Journal of the Linnean Society} }"},{"path":"https://gaballench.github.io/tbea/index.html","id":"problems","dir":"","previous_headings":"","what":"Problems?","title":"Pre- And Post-Processing in Bayesian Evolutionary Analyses","text":"find bug unexpected behavior, please file issue.","code":""},{"path":"https://gaballench.github.io/tbea/reference/andes.html","id":null,"dir":"Reference","previous_headings":"","what":"Divergence-time estimation data for cis-trans-Andean pairs — andes","title":"Divergence-time estimation data for cis-trans-Andean pairs — andes","text":"dataset containing point estimates uncertainty intervals divergence times clade pairs east west Andes, compiled Ballen (2020).","code":""},{"path":"https://gaballench.github.io/tbea/reference/andes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Divergence-time estimation data for cis-trans-Andean pairs — andes","text":"","code":"data(andes)"},{"path":"https://gaballench.github.io/tbea/reference/andes.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Divergence-time estimation data for cis-trans-Andean pairs — andes","text":"data frame three columns: ages Estimated age (Ma) given rock sample min Standard deviation age estimate max Sample code Table 3.2","code":""},{"path":"https://gaballench.github.io/tbea/reference/andes.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Divergence-time estimation data for cis-trans-Andean pairs — andes","text":"Ballen, Gustavo . 2020. Fossil freshwater fishes biogeography northern South America. 2020. PhD thesis, Museu de Zoologia, Universidade de São Paulo, São Paulo, 2020. doi:10.11606/T.38.2020.tde-06052020-181631.","code":""},{"path":"https://gaballench.github.io/tbea/reference/c_truncauchy.html","id":null,"dir":"Reference","previous_headings":"","what":"c_truncauchy: Estimate the c parameter for the truncated cauchy L distribution to be used in MCMCTree — c_truncauchy","title":"c_truncauchy: Estimate the c parameter for the truncated cauchy L distribution to be used in MCMCTree — c_truncauchy","text":"c_truncauchy: Estimate c parameter truncated cauchy L distribution used MCMCTree","code":""},{"path":"https://gaballench.github.io/tbea/reference/c_truncauchy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"c_truncauchy: Estimate the c parameter for the truncated cauchy L distribution to be used in MCMCTree — c_truncauchy","text":"","code":"c_truncauchy(tl, tr, p = 0.1, pr = 0.975, al = 0.025, output = \"par\")"},{"path":"https://gaballench.github.io/tbea/reference/c_truncauchy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"c_truncauchy: Estimate the c parameter for the truncated cauchy L distribution to be used in MCMCTree — c_truncauchy","text":"tl minimum age. tr maximum age p constant p involved Cauchy parameters location scale. Set 0.1 default. determines close mode distribution tl min age. pr percentile right distribution (0.975 default) al alpha right minimum x. Set zero hard minimum desired, otherwise random variable can take values t_L probability al. Set 0.025 default. output Whether return just parameters optimisation output. Defaults \"par\". Leave blank \"\" different text order return optimisation output.","code":""},{"path":"https://gaballench.github.io/tbea/reference/c_truncauchy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"c_truncauchy: Estimate the c parameter for the truncated cauchy L distribution to be used in MCMCTree — c_truncauchy","text":"Either parameter optimisation value numeric vector length one (output=\"par\") complete optimisation output list (otherwise)","code":""},{"path":"https://gaballench.github.io/tbea/reference/c_truncauchy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"c_truncauchy: Estimate the c parameter for the truncated cauchy L distribution to be used in MCMCTree — c_truncauchy","text":"solve c fixing p=0.1 mode distribution closer t_L calculate c t_R desired max age. note ar al complements, thus can 0.025. Optimisation proceeds fixing p t_L(1-p) using numerical optimisation find c c*t_L.","code":""},{"path":"https://gaballench.github.io/tbea/reference/c_truncauchy.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"c_truncauchy: Estimate the c parameter for the truncated cauchy L distribution to be used in MCMCTree — c_truncauchy","text":"Gustavo . Ballen","code":""},{"path":"https://gaballench.github.io/tbea/reference/c_truncauchy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"c_truncauchy: Estimate the c parameter for the truncated cauchy L distribution to be used in MCMCTree — c_truncauchy","text":"","code":"testValues.tr <- c(4.93, 12.12, 24.43, 49.20) # the values below should be approx. c = 0.2, 0.5, 1, 2 # according to the paml documentation for (i in testValues.tr) {     print(c_truncauchy(tl=1, tr=i, p=0.1, pr=0.975, al=0.025)) } #> [1] 0.1999785 #> [1] 0.4999731 #> [1] 0.9998983 #> [1] 2.00008"},{"path":"https://gaballench.github.io/tbea/reference/concatNexus.html","id":null,"dir":"Reference","previous_headings":"","what":"concatNexus: Function for concatenation of nexus matrices both morphological and molecular — concatNexus","title":"concatNexus: Function for concatenation of nexus matrices both morphological and molecular — concatNexus","text":"concatNexus: Function concatenation nexus matrices morphological molecular","code":""},{"path":"https://gaballench.github.io/tbea/reference/concatNexus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"concatNexus: Function for concatenation of nexus matrices both morphological and molecular — concatNexus","text":"","code":"concatNexus(   matrices = NULL,   pattern,   path,   filename,   morpho = FALSE,   morphoFilename = NULL,   sumFilename )"},{"path":"https://gaballench.github.io/tbea/reference/concatNexus.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"concatNexus: Function for concatenation of nexus matrices both morphological and molecular — concatNexus","text":"matrices vector type 'character' paths nexus alignments file names. morphoFilename non-null, either path morphological partition file name must included . default NULL must defined none pattern path included. pattern vector type 'character' length one containing text pattern identify alignments interest. tipically suffix /file extension (see examples). path vector type 'character' length one pointing directory matrices located. used combination pattern order build path matrix file (see examples). filename vector type 'character' length one file name (path file name) concatenated output matrix. morpho vector type 'logical' length one indicating whether morphological matrix included concatenation. morphoFilename vector type 'character' length one file name path morphological nexus matrix. Needed morpho = TRUE. sumFilename vector type 'character' length one file name path summary information partition start end positions. Useful specifying concatenated analyses MrBayes partition matrix might substitution model.","code":""},{"path":"https://gaballench.github.io/tbea/reference/concatNexus.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"concatNexus: Function for concatenation of nexus matrices both morphological and molecular — concatNexus","text":"function writes disk two files, one concatenated matrix one summary information partition positions complete matrix.","code":""},{"path":"https://gaballench.github.io/tbea/reference/concatNexus.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"concatNexus: Function for concatenation of nexus matrices both morphological and molecular — concatNexus","text":"function concatenate matrices nexus format (mandatory) write disk output summary information partitions. requires input matrices share taxa positions.","code":""},{"path":"https://gaballench.github.io/tbea/reference/concatNexus.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"concatNexus: Function for concatenation of nexus matrices both morphological and molecular — concatNexus","text":"Gustavo . Ballen","code":""},{"path":"https://gaballench.github.io/tbea/reference/concatNexus.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"concatNexus: Function for concatenation of nexus matrices both morphological and molecular — concatNexus","text":"","code":"# Concatenate all the matrices in a given path, # ending with the pattern 'aligned.nex', including a morphological matrix # also defined with a pattern if (FALSE) { # \\dontrun{ path <- \"sequences\" pattern <- \"aligned.nex$\"  concatNexus(matrices = NULL, pattern = pattern,             filename = paste(path, \"concatenatedMolmorph.nexus\", sep = \"/\"),             path = path,              morpho = TRUE,             morphoFilename = paste(path, grep(pattern = \"morfologia\",                                               x = dir(path, pattern), value = TRUE),                                    sep = \"/\"),             sumFilename = \"partitions.txt\") } # } # Concatenate arbitrary matrices in the working directory, # including a morphological matrix, return a concatenated file in the same dir if (FALSE) { # \\dontrun{ concatNexus(matrices = c(\"coi.nex\", \"rag1.nex\", \"cytb.nex\", \"morphology.nex\"),             filename = \"concatenatedMolmorph.nexus\",              morpho = TRUE,             morphoFilename = \"morphology.nex\",             sumFilename = \"partitions.txt\") } # }"},{"path":"https://gaballench.github.io/tbea/reference/conflate.html","id":null,"dir":"Reference","previous_headings":"","what":"conflate: Calculate the conflation of multiple distributions pdfs, plot = TRUE, from, to, n, add = FALSE — conflate","title":"conflate: Calculate the conflation of multiple distributions pdfs, plot = TRUE, from, to, n, add = FALSE — conflate","text":"conflate: Calculate conflation multiple distributions pdfs, plot = TRUE, , , n, add = FALSE","code":""},{"path":"https://gaballench.github.io/tbea/reference/conflate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"conflate: Calculate the conflation of multiple distributions pdfs, plot = TRUE, from, to, n, add = FALSE — conflate","text":"","code":"conflate(pdfs, plot = TRUE, from, to, n, add = FALSE)"},{"path":"https://gaballench.github.io/tbea/reference/conflate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"conflate: Calculate the conflation of multiple distributions pdfs, plot = TRUE, from, to, n, add = FALSE — conflate","text":"pdfs vector calls density_fun defininf individual distribution. plot Whether plot using curve , , n appropriate values calculate conflation, number points n. used function curve still necessary even plot required. add Whether add curve existing plot.","code":""},{"path":"https://gaballench.github.io/tbea/reference/conflate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"conflate: Calculate the conflation of multiple distributions pdfs, plot = TRUE, from, to, n, add = FALSE — conflate","text":"data frame coordinates x-y conflated curve.","code":""},{"path":"https://gaballench.github.io/tbea/reference/conflate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"conflate: Calculate the conflation of multiple distributions pdfs, plot = TRUE, from, to, n, add = FALSE — conflate","text":"Produces either plot data frame x y values conflated PDF. uses input vector densities constructed density_fun, parameters pased curve plot desired still used returning data frame x y values evaluation conflated PDF sequence x values determined number n equidistant points .","code":""},{"path":"https://gaballench.github.io/tbea/reference/conflate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"conflate: Calculate the conflation of multiple distributions pdfs, plot = TRUE, from, to, n, add = FALSE — conflate","text":"","code":"# \\donttest{ conflated_normals <- conflate(c(\"density_fun(x, 'dnorm', mean=0, sd=1)\",                                 \"density_fun(x, 'dnorm', mean=3, sd=1)\"),                               from=-4, to=4, n=101, plot=FALSE) plot(conflated_normals)  # }"},{"path":"https://gaballench.github.io/tbea/reference/crossplot.html","id":null,"dir":"Reference","previous_headings":"","what":"crossplot: Plot the mean/median and HPD interval bars for pairs of distributions — crossplot","title":"crossplot: Plot the mean/median and HPD interval bars for pairs of distributions — crossplot","text":"crossplot: Plot mean/median HPD interval bars pairs distributions","code":""},{"path":"https://gaballench.github.io/tbea/reference/crossplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"crossplot: Plot the mean/median and HPD interval bars for pairs of distributions — crossplot","text":"","code":"crossplot(   log1,   log2,   skip.char = \"#\",   pattern = NULL,   stat = \"median\",   idx.cols = NULL,   bar.lty,   bar.lwd,   identity.lty,   identity.lwd,   extra.space = 0.5,   ... )"},{"path":"https://gaballench.github.io/tbea/reference/crossplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"crossplot: Plot the mean/median and HPD interval bars for pairs of distributions — crossplot","text":"log1 either character vector length 1 path first log file (e.g. prior node ages), dataframe independent samples rows values compare columns (e.g. node IDs). log2 either character vector length 1 path second log file (e.g. posterior node ages), dataframe independent samples rows values compare columns (e.g. node IDs). skip.char character vector length 1, '#' default value. symbol used comment. allow ignore lines start symbol reading data. pattern character vector length 1. pattern subsetting columns containing data plotted. stat use mean median distribution plot. Median used default. idx.cols either integer vector position columns pick, character vector column names pick. Defaults NULL. bar.lty line type used error bars. bar.lwd width identity.lty line type used identity y = x line identity.lwd width. extra.space numeric vector length 1. much space allowed xlim ylim depending smallest value highest density intervals plus minus extra.space. value 0.5 units dimension interest used default. ... Optional arguments passed `plot` `main`, `xlab`, `ylab`, `pch` `cex`.","code":""},{"path":"https://gaballench.github.io/tbea/reference/crossplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"crossplot: Plot the mean/median and HPD interval bars for pairs of distributions — crossplot","text":"function returns nothing, plots graphical device.","code":""},{"path":"https://gaballench.github.io/tbea/reference/crossplot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"crossplot: Plot the mean/median and HPD interval bars for pairs of distributions — crossplot","text":"function produces crossplot, scatterplot comparing two distributions associated point means medians points, highest density intervals bars around point. instance, x may represent prior set parameters y represents posterior. Error bars x axis highest density intervals prior, y axis represent interval posterior. function can also used compare two independent runs (visual) convergence: sampling posterior distribution, fall identity y=x line.","code":""},{"path":"https://gaballench.github.io/tbea/reference/crossplot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"crossplot: Plot the mean/median and HPD interval bars for pairs of distributions — crossplot","text":"Gustavo . Ballen Sandra Reinales","code":""},{"path":"https://gaballench.github.io/tbea/reference/crossplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"crossplot: Plot the mean/median and HPD interval bars for pairs of distributions — crossplot","text":"","code":"## Create log dataframes log1 <- data.frame(sample=seq(from=1, to=10000, by = 100),                    node1=rnorm(n =100, mean=41, sd=0.5),                    node2=rnorm(n =100, mean=50, sd=1),                    node3=rnorm(n =100, mean=25, sd=1))  log2 <- data.frame(sample=seq(from=1, to=10000, by = 100),                    node1=rnorm(n =100, mean=41, sd=0.2),                    node2=rnorm(n =100, mean=50, sd=0.8),                    node3=rnorm(n =100, mean=25, sd=0.5))                     ## Run crossplot crossplot(log1, log2, pattern=\"node\", cols=NULL, stat=\"mean\",           bar.lty=1, bar.lwd=1, identity.lty=2, identity.lwd=1,           extra.space=0.5, main=\"My plot\", xlab=\"log 1 (prior)\",           ylab=\"log 2 (posterior)\", pch=19)   if (FALSE) { # \\dontrun{ ## Run crossplot over log files crossplot(log1=\"log1.tsv\", log2=\"log2.tsv\", stat=\"median\", skip.char=\"#\",           pattern=\"par\", cols=NULL, bar.lty=1, bar.lwd=1,           identity.lty=2, identity.lwd=1,           extra.space=0.5, main=\"My plot\", xlab=\"log 1 (prior)\",           ylab=\"log 2 (posterior)\", pch=19) } # }"},{"path":"https://gaballench.github.io/tbea/reference/cynodontidae.posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior samples for the family Cynodontidae — cynodontidae.posterior","title":"Posterior samples for the family Cynodontidae — cynodontidae.posterior","text":"data frame posterior MCMC samples divergence time estimation analysis family Cynodontidae using Beast2. original sample 20000, include last 1000 samples preserve columns node ages.","code":""},{"path":"https://gaballench.github.io/tbea/reference/cynodontidae.posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior samples for the family Cynodontidae — cynodontidae.posterior","text":"","code":"data(cynodontidae.posterior)"},{"path":"https://gaballench.github.io/tbea/reference/cynodontidae.posterior.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Posterior samples for the family Cynodontidae — cynodontidae.posterior","text":"data frame named cynodontidae.posterior six columns: Sample ID generation sampling mrca.date.backward.Hydrolycus. Node ages node Hydrolycus mrca.date.backward.Cynodontidae. Node ages node Cynodontidae mrca.date.backward.Cynodon_Hydrolycus. Node ages node Cynodon-Hydrolycus mrca.date.backward.H_scomberoides. Node ages node H. scomberoides mrca.date.backward.Cynodon. Node ages node Cynodon","code":""},{"path":"https://gaballench.github.io/tbea/reference/cynodontidae.posterior.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Posterior samples for the family Cynodontidae — cynodontidae.posterior","text":"Ballen, G.. Reinales, S. 2025. tbea: tools pre- post-processing Bayesian evolutionary analyses. BioRxiv https://www.biorxiv.org/content/10.1101/2024.06.18.599561. Ballen, G.., Moreno-Bernal, J.W. & Jaramillo, C. 2022. fossil record Saber-Tooth Characins (Teleostei: Characiformes: Cynodontinae), phylogenetic relationships, paleobiogeographical implications. Journal Systematic Palaeontology 19:24, 1679-1692, DOI: 10.1080/14772019.2022.2070717","code":""},{"path":"https://gaballench.github.io/tbea/reference/cynodontidae.prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior samples for the family Cynodontidae — cynodontidae.prior","title":"Prior samples for the family Cynodontidae — cynodontidae.prior","text":"data frame prior MCMC samples divergence time estimation analysis family Cynodontidae using Beast2. original sample 20000, include last 1000 samples preserve columns node ages.","code":""},{"path":"https://gaballench.github.io/tbea/reference/cynodontidae.prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior samples for the family Cynodontidae — cynodontidae.prior","text":"","code":"data(cynodontidae.prior)"},{"path":"https://gaballench.github.io/tbea/reference/cynodontidae.prior.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Prior samples for the family Cynodontidae — cynodontidae.prior","text":"data frame named cynodontidae.prior six columns: Sample ID generation sampling mrca.date.backward.Hydrolycus. Node ages node Hydrolycus mrca.date.backward.Cynodontidae. Node ages node Cynodontidae mrca.date.backward.Cynodon_Hydrolycus. Node ages node Cynodon-Hydrolycus mrca.date.backward.H_scomberoides. Node ages node H. scomberoides mrca.date.backward.Cynodon. Node ages node Cynodon","code":""},{"path":"https://gaballench.github.io/tbea/reference/cynodontidae.prior.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Prior samples for the family Cynodontidae — cynodontidae.prior","text":"Ballen, G.. Reinales, S. 2025. tbea: tools pre- post-processing Bayesian evolutionary analyses. BioRxiv https://www.biorxiv.org/content/10.1101/2024.06.18.599561. Ballen, G.., Moreno-Bernal, J.W. & Jaramillo, C. 2022. fossil record Saber-Tooth Characins (Teleostei: Characiformes: Cynodontinae), phylogenetic relationships, paleobiogeographical implications. Journal Systematic Palaeontology 19:24, 1679-1692, DOI: 10.1080/14772019.2022.2070717","code":""},{"path":"https://gaballench.github.io/tbea/reference/density_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"density_fun: A way to represent distributions to be conflated — density_fun","title":"density_fun: A way to represent distributions to be conflated — density_fun","text":"density_fun: way represent distributions conflated","code":""},{"path":"https://gaballench.github.io/tbea/reference/density_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"density_fun: A way to represent distributions to be conflated — density_fun","text":"","code":"density_fun(x, dist, ...)"},{"path":"https://gaballench.github.io/tbea/reference/density_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"density_fun: A way to represent distributions to be conflated — density_fun","text":"x symbol needs present order allow passing values towards distruibution generator. just x, without quotation marks (see examples). dist character (using single quotes!) name distribution use. ... Parameters passed dist. See examples","code":""},{"path":"https://gaballench.github.io/tbea/reference/density_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"density_fun: A way to represent distributions to be conflated — density_fun","text":"call elements distribution used.","code":""},{"path":"https://gaballench.github.io/tbea/reference/density_fun.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"density_fun: A way to represent distributions to be conflated — density_fun","text":"Produces definition individual distribution conflated provides symbol non-standard evaluation (x). Single quotes dist mandatory order avoid issues calling expressions hood. See documentation individual distribution call parameters adequately. Argument names values used.","code":""},{"path":"https://gaballench.github.io/tbea/reference/density_fun.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"density_fun: A way to represent distributions to be conflated — density_fun","text":"","code":"# \\donttest{ c(\"density_fun(x, 'dnorm', mean=0, sd=1)\",   \"density_fun(x, 'dnorm', mean=-1, sd=1)\",   \"density_fun(x, 'dnorm', mean=1, sd=1)\") #> [1] \"density_fun(x, 'dnorm', mean=0, sd=1)\"  #> [2] \"density_fun(x, 'dnorm', mean=-1, sd=1)\" #> [3] \"density_fun(x, 'dnorm', mean=1, sd=1)\"  # }"},{"path":"https://gaballench.github.io/tbea/reference/fasta2nexus.html","id":null,"dir":"Reference","previous_headings":"","what":"fasta2nexus (deprecated): Function for converting molecular alignments from fasta to nexus format — fasta2nexus","title":"fasta2nexus (deprecated): Function for converting molecular alignments from fasta to nexus format — fasta2nexus","text":"fasta2nexus (deprecated): Function converting molecular alignments fasta nexus format","code":""},{"path":"https://gaballench.github.io/tbea/reference/fasta2nexus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"fasta2nexus (deprecated): Function for converting molecular alignments from fasta to nexus format — fasta2nexus","text":"","code":"fasta2nexus(...)"},{"path":"https://gaballench.github.io/tbea/reference/fasta2nexus.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"fasta2nexus (deprecated): Function for converting molecular alignments from fasta to nexus format — fasta2nexus","text":"... placeholder argument used function.","code":""},{"path":"https://gaballench.github.io/tbea/reference/fasta2nexus.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"fasta2nexus (deprecated): Function for converting molecular alignments from fasta to nexus format — fasta2nexus","text":"function returns error deprecated.","code":""},{"path":"https://gaballench.github.io/tbea/reference/fasta2nexus.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"fasta2nexus (deprecated): Function for converting molecular alignments from fasta to nexus format — fasta2nexus","text":"function deprecated tbea v1.0.0 onwards. using function please install tbea v0.5.0.","code":""},{"path":"https://gaballench.github.io/tbea/reference/fasta2nexus.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"fasta2nexus (deprecated): Function for converting molecular alignments from fasta to nexus format — fasta2nexus","text":"Gustavo . Ballen","code":""},{"path":"https://gaballench.github.io/tbea/reference/findParams.html","id":null,"dir":"Reference","previous_headings":"","what":"Function for estimation of probability density function parameters through quadratic optimization — findParams","title":"Function for estimation of probability density function parameters through quadratic optimization — findParams","text":"Function estimation probability density function parameters quadratic optimization","code":""},{"path":"https://gaballench.github.io/tbea/reference/findParams.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function for estimation of probability density function parameters through quadratic optimization — findParams","text":"","code":"findParams(q, p, output = \"complete\", pdfunction, params, initVals = NULL)"},{"path":"https://gaballench.github.io/tbea/reference/findParams.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function for estimation of probability density function parameters through quadratic optimization — findParams","text":"q numeric vector observed quantiles, might come HPD previous study (along median), sources prior information. See Details. p numeric vector percentiles. output One two possible values: \"complete\" \"parameters\". latter complete output optim function returned information convergence squared errors (might useless simple cases) just parameters. pdfunction character vector (length one) name PDF function interest. Technically argument supports PDF function form pDIST (e.g., pnorm, ppois, pexp). params character vector name parameter(s) optimize probability density function. match parameter names respective PDF function, e.g., \"lambda\" function ppois initVals numeric vector default value NULL. allows user provide initial values, althought discouraged cases.","code":""},{"path":"https://gaballench.github.io/tbea/reference/findParams.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function for estimation of probability density function parameters through quadratic optimization — findParams","text":"Either list complete output convergence, squared errors parameter values, just vector parameter values. Depends value output. Warnings may triggered function optim since optimization heuristic process, whenever given iteration results invalid value given combination parameters, optim function tries another combination values inform user problem warning. general can safely disregarded.","code":""},{"path":"https://gaballench.github.io/tbea/reference/findParams.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Function for estimation of probability density function parameters through quadratic optimization — findParams","text":"function comes handy whenever values uncertainty, (e.g., confidence intervals, HPDs, biostratigraphic age constrains) want express form probability density function form \\(P(x;\\theta)\\). values (quantiles) already corresponding percentiles, need way approximate parameters \\(\\theta\\) produce combination quantiles given percentiles given PDF. carried optimization quadratic error function. accomplished function optim. instance, estimated age fossil Lutetian, Eocene (41.2 47.8 Ma), want model uncertainty normal distribution, assume age boundaries quantiles percentiles 0.025 0.975 respectively, add thir pair midpoint corresponding percentile 0.5. information needed order estimate parameters mean sd functiono pnorm.","code":""},{"path":"https://gaballench.github.io/tbea/reference/findParams.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Function for estimation of probability density function parameters through quadratic optimization — findParams","text":"Main code Gustavo . Ballen important contributions expression call structure vectorized design Klaus Schliep (Klaus.Schliep@umb.edu).","code":""},{"path":"https://gaballench.github.io/tbea/reference/findParams.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function for estimation of probability density function parameters through quadratic optimization — findParams","text":"","code":"# Find the best parameters for a standard normal density that fit the observed quantiles # -1.644854, 0, and 1.644854, providing full output for the calculations in the form of # a list findParams(q = c(-1.959964, 0.000000, 1.959964),            p = c(0.025, 0.50, 0.975),            output = \"complete\",            pdfunction = \"pnorm\",            params = c(\"mean\", \"sd\")) #> Warning: initVals not provided, will use the mean of quantiles in q for _each_ of the parameters. Parameter estimates might not be reliable even though convergence is reported. #> $par #> [1] 0.0 0.1 #>  #> $value #> [1] 0.00125 #>  #> $counts #> function gradient  #>       33       NA  #>  #> $convergence #> [1] 0 #>  #> $message #> NULL #>   # Given that we have prior on the age of a fossil to be 1 - 10 Ma and that we want to # model it with a lognormal distribution, fin the parameters of the PDF that best reflect # the uncertainty in question (i.e., the parameters  for which the observed quantiles are # 1, 5.5, and 10, assuming that we want the midpoint to reflect the mean of the PDF. findParams(q = c(1, 5.5, 10),            p = c(0.025,  0.50, 0.975),            output = \"complete\",            pdfunction = \"plnorm\",            params = c(\"meanlog\", \"sdlog\")) #> Warning: initVals not provided, will use the mean of quantiles in q for _each_ of the parameters. Parameter estimates might not be reliable even though convergence is reported. #> Warning: NaNs produced #> Warning: NaNs produced #> Warning: NaNs produced #> Warning: NaNs produced #> Warning: NaNs produced #> Warning: NaNs produced #> Warning: NaNs produced #> Warning: NaNs produced #> $par #> [1] 1.704744 0.305104 #>  #> $value #> [1] 0.0006250003 #>  #> $counts #> function gradient  #>      101       NA  #>  #> $convergence #> [1] 0 #>  #> $message #> NULL #>"},{"path":"https://gaballench.github.io/tbea/reference/laventa.html","id":null,"dir":"Reference","previous_headings":"","what":"Geochronology samples from the Honda Group in Colombia — laventa","title":"Geochronology samples from the Honda Group in Colombia — laventa","text":"dataset containing geochronology data several samples along stratigraphic column Honda Huila groups Tatacoa Desert area. dataset compiled Table 3.2 Flynn et al. (1997).","code":""},{"path":"https://gaballench.github.io/tbea/reference/laventa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Geochronology samples from the Honda Group in Colombia — laventa","text":"","code":"data(laventa)"},{"path":"https://gaballench.github.io/tbea/reference/laventa.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Geochronology samples from the Honda Group in Colombia — laventa","text":"data frame 87 rows 7 variables: age Estimated age (Ma) given rock sample one_sigma Standard deviation age estimate sample Sample code Table 3.2 unit Stratigraphic unit either Honda Group             Huila Group elevation Position stratigraphic column, meters mineral mineral used dating sample comments Comments footnotes original table","code":""},{"path":"https://gaballench.github.io/tbea/reference/laventa.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Geochronology samples from the Honda Group in Colombia — laventa","text":"Flynn, J.J., Guerrero, J. & Swisher III, C.C. (1997) Geochronology Honda Group. : R. F. Kay, R. H. Madden, R. L. Cifelli, J. J. Flynn (Eds), Vertebrate Paleontology Neotropics: Miocene Fauna La Venta, Colombia. Smithsonian Institution Press, pp. 44–60.","code":""},{"path":"https://gaballench.github.io/tbea/reference/lognormalBeast.html","id":null,"dir":"Reference","previous_headings":"","what":"Constructing a curve for the user-specified lognormal prior using Beast2 parameters — lognormalBeast","title":"Constructing a curve for the user-specified lognormal prior using Beast2 parameters — lognormalBeast","text":"Constructing curve user-specified lognormal prior using Beast2 parameters","code":""},{"path":"https://gaballench.github.io/tbea/reference/lognormalBeast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Constructing a curve for the user-specified lognormal prior using Beast2 parameters — lognormalBeast","text":"","code":"lognormalBeast(   M,   S,   meanInRealSpace = TRUE,   offset = 0,   from = NULL,   to = NULL,   by = 0.05 )"},{"path":"https://gaballench.github.io/tbea/reference/lognormalBeast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Constructing a curve for the user-specified lognormal prior using Beast2 parameters — lognormalBeast","text":"M Mean lognormal density Beast2. S Standard deviation lognormal density Beast2. meanInRealSpace Whether plot mean real- log-space (.e., apply log(M) plotting). Please see details. offset Hard lower bound. , , Starting ending point calculate considering offset zero. , affect produce starting point (offset + ) ending point (offset + ). sets step size sequence `` `` `` steps.","code":""},{"path":"https://gaballench.github.io/tbea/reference/lognormalBeast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Constructing a curve for the user-specified lognormal prior using Beast2 parameters — lognormalBeast","text":"matrix two columns consisting x y values lognormal density.","code":""},{"path":"https://gaballench.github.io/tbea/reference/lognormalBeast.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Constructing a curve for the user-specified lognormal prior using Beast2 parameters — lognormalBeast","text":"function creates matrix x,y values given parameters lognormal density specified program Beast2. main purpose plotting uses similarity quantification available. Please note value mean depends whether expect real log space. Please refer Heath (2015) info: Heath, T. . (2015). Divergence Time Estimation using BEAST v2.","code":""},{"path":"https://gaballench.github.io/tbea/reference/lognormalBeast.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Constructing a curve for the user-specified lognormal prior using Beast2 parameters — lognormalBeast","text":"","code":"# Generate a matrix for the lognormal density with mean 1 and standard deviation 1, with mean # in real space, and spanning values in x from 0 to 10 lognormalBeast(M = 1, S = 1, meanInRealSpace = TRUE, from = 0, to = 10) #>            x           y #>   [1,]  0.00 0.000000000 #>   [2,]  0.05 0.089778281 #>   [3,]  0.10 0.281590189 #>   [4,]  0.15 0.439837180 #>   [5,]  0.20 0.546267871 #>   [6,]  0.25 0.610455304 #>   [7,]  0.30 0.644203257 #>   [8,]  0.35 0.656928789 #>   [9,]  0.40 0.655444168 #>  [10,]  0.45 0.644527295 #>  [11,]  0.50 0.627496077 #>  [12,]  0.55 0.606648294 #>  [13,]  0.60 0.583573823 #>  [14,]  0.65 0.559370868 #>  [15,]  0.70 0.534794832 #>  [16,]  0.75 0.510361006 #>  [17,]  0.80 0.486415781 #>  [18,]  0.85 0.463186358 #>  [19,]  0.90 0.440815686 #>  [20,]  0.95 0.419387175 #>  [21,]  1.00 0.398942280 #>  [22,]  1.05 0.379493072 #>  [23,]  1.10 0.361031261 #>  [24,]  1.15 0.343534692 #>  [25,]  1.20 0.326972024 #>  [26,]  1.25 0.311306100 #>  [27,]  1.30 0.296496371 #>  [28,]  1.35 0.282500627 #>  [29,]  1.40 0.269276229 #>  [30,]  1.45 0.256780967 #>  [31,]  1.50 0.244973652 #>  [32,]  1.55 0.233814513 #>  [33,]  1.60 0.223265447 #>  [34,]  1.65 0.213290165 #>  [35,]  1.70 0.203854259 #>  [36,]  1.75 0.194925229 #>  [37,]  1.80 0.186472449 #>  [38,]  1.85 0.178467127 #>  [39,]  1.90 0.170882238 #>  [40,]  1.95 0.163692446 #>  [41,]  2.00 0.156874019 #>  [42,]  2.05 0.150404746 #>  [43,]  2.10 0.144263846 #>  [44,]  2.15 0.138431884 #>  [45,]  2.20 0.132890686 #>  [46,]  2.25 0.127623257 #>  [47,]  2.30 0.122613707 #>  [48,]  2.35 0.117847173 #>  [49,]  2.40 0.113309754 #>  [50,]  2.45 0.108988443 #>  [51,]  2.50 0.104871067 #>  [52,]  2.55 0.100946230 #>  [53,]  2.60 0.097203259 #>  [54,]  2.65 0.093632155 #>  [55,]  2.70 0.090223546 #>  [56,]  2.75 0.086968643 #>  [57,]  2.80 0.083859205 #>  [58,]  2.85 0.080887493 #>  [59,]  2.90 0.078046245 #>  [60,]  2.95 0.075328637 #>  [61,]  3.00 0.072728256 #>  [62,]  3.05 0.070239074 #>  [63,]  3.10 0.067855420 #>  [64,]  3.15 0.065571956 #>  [65,]  3.20 0.063383656 #>  [66,]  3.25 0.061285787 #>  [67,]  3.30 0.059273887 #>  [68,]  3.35 0.057343749 #>  [69,]  3.40 0.055491406 #>  [70,]  3.45 0.053713112 #>  [71,]  3.50 0.052005332 #>  [72,]  3.55 0.050364725 #>  [73,]  3.60 0.048788135 #>  [74,]  3.65 0.047272577 #>  [75,]  3.70 0.045815229 #>  [76,]  3.75 0.044413419 #>  [77,]  3.80 0.043064619 #>  [78,]  3.85 0.041766434 #>  [79,]  3.90 0.040516593 #>  [80,]  3.95 0.039312948 #>  [81,]  4.00 0.038153457 #>  [82,]  4.05 0.037036185 #>  [83,]  4.10 0.035959297 #>  [84,]  4.15 0.034921048 #>  [85,]  4.20 0.033919783 #>  [86,]  4.25 0.032953929 #>  [87,]  4.30 0.032021989 #>  [88,]  4.35 0.031122542 #>  [89,]  4.40 0.030254236 #>  [90,]  4.45 0.029415782 #>  [91,]  4.50 0.028605956 #>  [92,]  4.55 0.027823591 #>  [93,]  4.60 0.027067575 #>  [94,]  4.65 0.026336850 #>  [95,]  4.70 0.025630406 #>  [96,]  4.75 0.024947280 #>  [97,]  4.80 0.024286554 #>  [98,]  4.85 0.023647353 #>  [99,]  4.90 0.023028838 #> [100,]  4.95 0.022430213 #> [101,]  5.00 0.021850715 #> [102,]  5.05 0.021289614 #> [103,]  5.10 0.020746215 #> [104,]  5.15 0.020219852 #> [105,]  5.20 0.019709889 #> [106,]  5.25 0.019215716 #> [107,]  5.30 0.018736751 #> [108,]  5.35 0.018272437 #> [109,]  5.40 0.017822239 #> [110,]  5.45 0.017385647 #> [111,]  5.50 0.016962171 #> [112,]  5.55 0.016551341 #> [113,]  5.60 0.016152709 #> [114,]  5.65 0.015765843 #> [115,]  5.70 0.015390329 #> [116,]  5.75 0.015025771 #> [117,]  5.80 0.014671790 #> [118,]  5.85 0.014328019 #> [119,]  5.90 0.013994109 #> [120,]  5.95 0.013669723 #> [121,]  6.00 0.013354538 #> [122,]  6.05 0.013048244 #> [123,]  6.10 0.012750543 #> [124,]  6.15 0.012461147 #> [125,]  6.20 0.012179782 #> [126,]  6.25 0.011906183 #> [127,]  6.30 0.011640095 #> [128,]  6.35 0.011381274 #> [129,]  6.40 0.011129482 #> [130,]  6.45 0.010884494 #> [131,]  6.50 0.010646092 #> [132,]  6.55 0.010414065 #> [133,]  6.60 0.010188210 #> [134,]  6.65 0.009968333 #> [135,]  6.70 0.009754246 #> [136,]  6.75 0.009545768 #> [137,]  6.80 0.009342725 #> [138,]  6.85 0.009144949 #> [139,]  6.90 0.008952276 #> [140,]  6.95 0.008764553 #> [141,]  7.00 0.008581626 #> [142,]  7.05 0.008403352 #> [143,]  7.10 0.008229590 #> [144,]  7.15 0.008060204 #> [145,]  7.20 0.007895064 #> [146,]  7.25 0.007734044 #> [147,]  7.30 0.007577022 #> [148,]  7.35 0.007423879 #> [149,]  7.40 0.007274504 #> [150,]  7.45 0.007128786 #> [151,]  7.50 0.006986618 #> [152,]  7.55 0.006847899 #> [153,]  7.60 0.006712529 #> [154,]  7.65 0.006580413 #> [155,]  7.70 0.006451458 #> [156,]  7.75 0.006325575 #> [157,]  7.80 0.006202676 #> [158,]  7.85 0.006082679 #> [159,]  7.90 0.005965502 #> [160,]  7.95 0.005851066 #> [161,]  8.00 0.005739296 #> [162,]  8.05 0.005630119 #> [163,]  8.10 0.005523463 #> [164,]  8.15 0.005419260 #> [165,]  8.20 0.005317442 #> [166,]  8.25 0.005217945 #> [167,]  8.30 0.005120707 #> [168,]  8.35 0.005025667 #> [169,]  8.40 0.004932766 #> [170,]  8.45 0.004841948 #> [171,]  8.50 0.004753157 #> [172,]  8.55 0.004666339 #> [173,]  8.60 0.004581444 #> [174,]  8.65 0.004498420 #> [175,]  8.70 0.004417220 #> [176,]  8.75 0.004337795 #> [177,]  8.80 0.004260099 #> [178,]  8.85 0.004184090 #> [179,]  8.90 0.004109722 #> [180,]  8.95 0.004036955 #> [181,]  9.00 0.003965747 #> [182,]  9.05 0.003896060 #> [183,]  9.10 0.003827854 #> [184,]  9.15 0.003761094 #> [185,]  9.20 0.003695741 #> [186,]  9.25 0.003631763 #> [187,]  9.30 0.003569124 #> [188,]  9.35 0.003507792 #> [189,]  9.40 0.003447734 #> [190,]  9.45 0.003388919 #> [191,]  9.50 0.003331316 #> [192,]  9.55 0.003274898 #> [193,]  9.60 0.003219633 #> [194,]  9.65 0.003165496 #> [195,]  9.70 0.003112458 #> [196,]  9.75 0.003060494 #> [197,]  9.80 0.003009577 #> [198,]  9.85 0.002959684 #> [199,]  9.90 0.002910789 #> [200,]  9.95 0.002862869 #> [201,] 10.00 0.002815902 # The same as above but with an offset of 10, that is, the curve starts at 10 as if it was 0 # to values will start in (offset + from) and finish in (offset + to) lognormalBeast(M = 1, S = 1, meanInRealSpace = TRUE, offset = 10, from = 0, to = 10) #>            x           y #>   [1,] 10.00 0.000000000 #>   [2,] 10.05 0.089778281 #>   [3,] 10.10 0.281590189 #>   [4,] 10.15 0.439837180 #>   [5,] 10.20 0.546267871 #>   [6,] 10.25 0.610455304 #>   [7,] 10.30 0.644203257 #>   [8,] 10.35 0.656928789 #>   [9,] 10.40 0.655444168 #>  [10,] 10.45 0.644527295 #>  [11,] 10.50 0.627496077 #>  [12,] 10.55 0.606648294 #>  [13,] 10.60 0.583573823 #>  [14,] 10.65 0.559370868 #>  [15,] 10.70 0.534794832 #>  [16,] 10.75 0.510361006 #>  [17,] 10.80 0.486415781 #>  [18,] 10.85 0.463186358 #>  [19,] 10.90 0.440815686 #>  [20,] 10.95 0.419387175 #>  [21,] 11.00 0.398942280 #>  [22,] 11.05 0.379493072 #>  [23,] 11.10 0.361031261 #>  [24,] 11.15 0.343534692 #>  [25,] 11.20 0.326972024 #>  [26,] 11.25 0.311306100 #>  [27,] 11.30 0.296496371 #>  [28,] 11.35 0.282500627 #>  [29,] 11.40 0.269276229 #>  [30,] 11.45 0.256780967 #>  [31,] 11.50 0.244973652 #>  [32,] 11.55 0.233814513 #>  [33,] 11.60 0.223265447 #>  [34,] 11.65 0.213290165 #>  [35,] 11.70 0.203854259 #>  [36,] 11.75 0.194925229 #>  [37,] 11.80 0.186472449 #>  [38,] 11.85 0.178467127 #>  [39,] 11.90 0.170882238 #>  [40,] 11.95 0.163692446 #>  [41,] 12.00 0.156874019 #>  [42,] 12.05 0.150404746 #>  [43,] 12.10 0.144263846 #>  [44,] 12.15 0.138431884 #>  [45,] 12.20 0.132890686 #>  [46,] 12.25 0.127623257 #>  [47,] 12.30 0.122613707 #>  [48,] 12.35 0.117847173 #>  [49,] 12.40 0.113309754 #>  [50,] 12.45 0.108988443 #>  [51,] 12.50 0.104871067 #>  [52,] 12.55 0.100946230 #>  [53,] 12.60 0.097203259 #>  [54,] 12.65 0.093632155 #>  [55,] 12.70 0.090223546 #>  [56,] 12.75 0.086968643 #>  [57,] 12.80 0.083859205 #>  [58,] 12.85 0.080887493 #>  [59,] 12.90 0.078046245 #>  [60,] 12.95 0.075328637 #>  [61,] 13.00 0.072728256 #>  [62,] 13.05 0.070239074 #>  [63,] 13.10 0.067855420 #>  [64,] 13.15 0.065571956 #>  [65,] 13.20 0.063383656 #>  [66,] 13.25 0.061285787 #>  [67,] 13.30 0.059273887 #>  [68,] 13.35 0.057343749 #>  [69,] 13.40 0.055491406 #>  [70,] 13.45 0.053713112 #>  [71,] 13.50 0.052005332 #>  [72,] 13.55 0.050364725 #>  [73,] 13.60 0.048788135 #>  [74,] 13.65 0.047272577 #>  [75,] 13.70 0.045815229 #>  [76,] 13.75 0.044413419 #>  [77,] 13.80 0.043064619 #>  [78,] 13.85 0.041766434 #>  [79,] 13.90 0.040516593 #>  [80,] 13.95 0.039312948 #>  [81,] 14.00 0.038153457 #>  [82,] 14.05 0.037036185 #>  [83,] 14.10 0.035959297 #>  [84,] 14.15 0.034921048 #>  [85,] 14.20 0.033919783 #>  [86,] 14.25 0.032953929 #>  [87,] 14.30 0.032021989 #>  [88,] 14.35 0.031122542 #>  [89,] 14.40 0.030254236 #>  [90,] 14.45 0.029415782 #>  [91,] 14.50 0.028605956 #>  [92,] 14.55 0.027823591 #>  [93,] 14.60 0.027067575 #>  [94,] 14.65 0.026336850 #>  [95,] 14.70 0.025630406 #>  [96,] 14.75 0.024947280 #>  [97,] 14.80 0.024286554 #>  [98,] 14.85 0.023647353 #>  [99,] 14.90 0.023028838 #> [100,] 14.95 0.022430213 #> [101,] 15.00 0.021850715 #> [102,] 15.05 0.021289614 #> [103,] 15.10 0.020746215 #> [104,] 15.15 0.020219852 #> [105,] 15.20 0.019709889 #> [106,] 15.25 0.019215716 #> [107,] 15.30 0.018736751 #> [108,] 15.35 0.018272437 #> [109,] 15.40 0.017822239 #> [110,] 15.45 0.017385647 #> [111,] 15.50 0.016962171 #> [112,] 15.55 0.016551341 #> [113,] 15.60 0.016152709 #> [114,] 15.65 0.015765843 #> [115,] 15.70 0.015390329 #> [116,] 15.75 0.015025771 #> [117,] 15.80 0.014671790 #> [118,] 15.85 0.014328019 #> [119,] 15.90 0.013994109 #> [120,] 15.95 0.013669723 #> [121,] 16.00 0.013354538 #> [122,] 16.05 0.013048244 #> [123,] 16.10 0.012750543 #> [124,] 16.15 0.012461147 #> [125,] 16.20 0.012179782 #> [126,] 16.25 0.011906183 #> [127,] 16.30 0.011640095 #> [128,] 16.35 0.011381274 #> [129,] 16.40 0.011129482 #> [130,] 16.45 0.010884494 #> [131,] 16.50 0.010646092 #> [132,] 16.55 0.010414065 #> [133,] 16.60 0.010188210 #> [134,] 16.65 0.009968333 #> [135,] 16.70 0.009754246 #> [136,] 16.75 0.009545768 #> [137,] 16.80 0.009342725 #> [138,] 16.85 0.009144949 #> [139,] 16.90 0.008952276 #> [140,] 16.95 0.008764553 #> [141,] 17.00 0.008581626 #> [142,] 17.05 0.008403352 #> [143,] 17.10 0.008229590 #> [144,] 17.15 0.008060204 #> [145,] 17.20 0.007895064 #> [146,] 17.25 0.007734044 #> [147,] 17.30 0.007577022 #> [148,] 17.35 0.007423879 #> [149,] 17.40 0.007274504 #> [150,] 17.45 0.007128786 #> [151,] 17.50 0.006986618 #> [152,] 17.55 0.006847899 #> [153,] 17.60 0.006712529 #> [154,] 17.65 0.006580413 #> [155,] 17.70 0.006451458 #> [156,] 17.75 0.006325575 #> [157,] 17.80 0.006202676 #> [158,] 17.85 0.006082679 #> [159,] 17.90 0.005965502 #> [160,] 17.95 0.005851066 #> [161,] 18.00 0.005739296 #> [162,] 18.05 0.005630119 #> [163,] 18.10 0.005523463 #> [164,] 18.15 0.005419260 #> [165,] 18.20 0.005317442 #> [166,] 18.25 0.005217945 #> [167,] 18.30 0.005120707 #> [168,] 18.35 0.005025667 #> [169,] 18.40 0.004932766 #> [170,] 18.45 0.004841948 #> [171,] 18.50 0.004753157 #> [172,] 18.55 0.004666339 #> [173,] 18.60 0.004581444 #> [174,] 18.65 0.004498420 #> [175,] 18.70 0.004417220 #> [176,] 18.75 0.004337795 #> [177,] 18.80 0.004260099 #> [178,] 18.85 0.004184090 #> [179,] 18.90 0.004109722 #> [180,] 18.95 0.004036955 #> [181,] 19.00 0.003965747 #> [182,] 19.05 0.003896060 #> [183,] 19.10 0.003827854 #> [184,] 19.15 0.003761094 #> [185,] 19.20 0.003695741 #> [186,] 19.25 0.003631763 #> [187,] 19.30 0.003569124 #> [188,] 19.35 0.003507792 #> [189,] 19.40 0.003447734 #> [190,] 19.45 0.003388919 #> [191,] 19.50 0.003331316 #> [192,] 19.55 0.003274898 #> [193,] 19.60 0.003219633 #> [194,] 19.65 0.003165496 #> [195,] 19.70 0.003112458 #> [196,] 19.75 0.003060494 #> [197,] 19.80 0.003009577 #> [198,] 19.85 0.002959684 #> [199,] 19.90 0.002910789 #> [200,] 19.95 0.002862869 #> [201,] 20.00 0.002815902"},{"path":"https://gaballench.github.io/tbea/reference/measureSimil.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the Intersection Between Two Densities — measureSimil","title":"Calculate the Intersection Between Two Densities — measureSimil","text":"Calculate Intersection Two Densities","code":""},{"path":"https://gaballench.github.io/tbea/reference/measureSimil.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the Intersection Between Two Densities — measureSimil","text":"","code":"measureSimil(   d1,   d2,   splits = 500,   rawData = c(TRUE, TRUE),   plot = TRUE,   x_limit = \"auto\",   colors = c(\"red\", \"blue\", \"gray\"),   ... )"},{"path":"https://gaballench.github.io/tbea/reference/measureSimil.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the Intersection Between Two Densities — measureSimil","text":"d1, d2 Either two vectors empirical (.e., MCMC-produced) values data.frame/matrix columns x y values fitted density calculate areas. rawData set TRUE instance, data must placed vectors multidimensional objects. splits numerical argument controling number subdivisions intersection area numerical integration rawData d1 /d2 raw data density calculated? vector length two containing logical values indicating whenther arguments d1 d2 raw data whether user inputing already calculated densities (e.g., output density, curve, dDIST functions, two-dimension object x y values) plot plot produced? x_limit Whether define xlim form min-max combined density x-values colors vector three colors, namely, color d1 density (e.g., prior), color d2 density e.g., posterior), color intersection. ... arguments pass graphical functions lines plot internally (e.g., main, xlim, ylim, xlab, ylab, etc.).","code":""},{"path":"https://gaballench.github.io/tbea/reference/measureSimil.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the Intersection Between Two Densities — measureSimil","text":"numeric vector value intersection two densities. side effect, plot produced active (new) graphical device.","code":""},{"path":"https://gaballench.github.io/tbea/reference/measureSimil.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate the Intersection Between Two Densities — measureSimil","text":"Similarity measured overlapping portion two densities. value 0 1. values vector rawData determine behavior function therefore attention must paid consistence nature arguments d1 d2. Despite function designed order allow quantify similarity posterior prior, can used quantify overlap two given densities purpose.","code":""},{"path":"https://gaballench.github.io/tbea/reference/measureSimil.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the Intersection Between Two Densities — measureSimil","text":"","code":"# \\donttest{ # Set seed and colors to use in plots in the order: Prior, posterior, and intersection set.seed(1985) colors <- c(\"red\", \"blue\", \"lightgray\") # Similarity between two identical distributions below <- measureSimil(d1 = rnorm(1000000, mean = 0, 1),                        d2 = rnorm(1000000, mean = 0, 1),                        main = \"Comp. similarity\",                        colors = colors) legend(x = \"topright\", legend = round(below, digits = 2))  # Similarity in two distributions partially overlapping below <- measureSimil(d1 = rnorm(1000000, mean = 3, 1),                        d2 = rnorm(1000000, mean = 0, 1),                        main = \"Partial similarity\",                        colors = colors) legend(x = \"topright\", legend = round(below, digits = 2))  # Similarity in two completely-different distributions below <- measureSimil(d1 = rnorm(1000000, mean = 8, 1),                        d2 = rnorm(1000000, mean = 0, 1),                        main = \"Comp. dissimilarity\",                        colors = colors) legend(x = \"topright\", legend = round(below, digits = 2))  # Don't plot, just return the intersection measureSimil(d1 = rnorm(1000000, mean = 3, 1),               d2 = rnorm(1000000, mean = 0, 1),               plot = FALSE) #> [1] 0.1336534 # }"},{"path":"https://gaballench.github.io/tbea/reference/mswd.test.html","id":null,"dir":"Reference","previous_headings":"","what":"Reduced chi-square test or mean square weighted deviation (mswd) test — mswd.test","title":"Reduced chi-square test or mean square weighted deviation (mswd) test — mswd.test","text":"Reduced chi-square test mean square weighted deviation (mswd) test","code":""},{"path":"https://gaballench.github.io/tbea/reference/mswd.test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reduced chi-square test or mean square weighted deviation (mswd) test — mswd.test","text":"","code":"mswd.test(age, sd)"},{"path":"https://gaballench.github.io/tbea/reference/mswd.test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reduced chi-square test or mean square weighted deviation (mswd) test — mswd.test","text":"age vector age radiometric age estimates sd vector standard deviation corresponding element age","code":""},{"path":"https://gaballench.github.io/tbea/reference/mswd.test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reduced chi-square test or mean square weighted deviation (mswd) test — mswd.test","text":"numeric vector length one p-value corresponding test.","code":""},{"path":"https://gaballench.github.io/tbea/reference/mswd.test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Reduced chi-square test or mean square weighted deviation (mswd) test — mswd.test","text":"Ludwig (2003:646): \"convention,  probabilities   fit  greater   0.05   generally considered   arguably  satisfying   mathematical  assumptions    isochron,   lower probabilities generally taken indicating presence “geological” scatter, hence significant possibility bias isochron age.\". null hypothesis isochron conditions hold.","code":""},{"path":"https://gaballench.github.io/tbea/reference/mswd.test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reduced chi-square test or mean square weighted deviation (mswd) test — mswd.test","text":"","code":"data(laventa) # Do the age estimates for the boundaries of the Honda Group (i.e., samples at meters 56.4 # and 675.0) conform to the isochron hypothesis? hondaIndex <- which(laventa$elevation == 56.4 | laventa$elevation == 675.0)  mswd.test(age = laventa$age[hondaIndex], sd = laventa$one_sigma[hondaIndex]) #> [1] 3.697832e-11 # The p-value is smaller than the nominal alpha of 0.05, so we can reject the null # hypothesis of isochron conditions  # Do the age estimates for the samples JG-R 88-2 and JG-R 89-2 conform to the isochron hypothesis? twoLevelsIndex <- which(laventa$sample == \"JG-R 89-2\" | laventa$sample == \"JG-R 88-2\") dataset <- laventa[twoLevelsIndex, ] # Remove the values 21 and 23 because of their abnormally large standard deviations mswd.test(age = dataset$age[c(-21, -23)], sd = dataset$one_sigma[c(-21, -23)]) #> [1] 0.993701 # The p-value is larger than the nominal alpha of 0.05, so we can # not reject the null hypothesis of isochron conditions"},{"path":"https://gaballench.github.io/tbea/reference/quantile_conflation.html","id":null,"dir":"Reference","previous_headings":"","what":"quantile_conflation: Calculate the quantile for a given probabiliy under a conflated distribution — quantile_conflation","title":"quantile_conflation: Calculate the quantile for a given probabiliy under a conflated distribution — quantile_conflation","text":"quantile_conflation: Calculate quantile given probabiliy conflated distribution","code":""},{"path":"https://gaballench.github.io/tbea/reference/quantile_conflation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"quantile_conflation: Calculate the quantile for a given probabiliy under a conflated distribution — quantile_conflation","text":"","code":"quantile_conflation(p, data, output = c(\"quantile\", \"optim\"))"},{"path":"https://gaballench.github.io/tbea/reference/quantile_conflation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"quantile_conflation: Calculate the quantile for a given probabiliy under a conflated distribution — quantile_conflation","text":"p float desired probability quantile calculated. data data frame results calling `conflate`. output One two values, either \"quantile\" \"optim\". former returns optimised quantile value, whereas latter returns complete output `optim`. Useful checking whether optimisation converged.","code":""},{"path":"https://gaballench.github.io/tbea/reference/quantile_conflation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"quantile_conflation: Calculate the quantile for a given probabiliy under a conflated distribution — quantile_conflation","text":"Either vector length one withe quantile value, list returned optim.","code":""},{"path":"https://gaballench.github.io/tbea/reference/quantile_conflation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"quantile_conflation: Calculate the quantile for a given probabiliy under a conflated distribution — quantile_conflation","text":"","code":"# \\donttest{ conflated = density(rnorm(1000000, 0, 1))[c(\"x\", \"y\")] quantile_conflation(0.5, conflated, output = \"quantile\") #> [1] -3.549484e-05 quantile_conflation(0.5, conflated, output = \"opt\") #> $par #> [1] -3.549484e-05 #>  #> $value #> [1] 3.240247e-19 #>  #> $counts #> function gradient  #>       NA       NA  #>  #> $convergence #> [1] 0 #>  #> $message #> NULL #>  quantile_conflation(0.025, conflated, \"quan\") #> [1] -1.962487 quantile_conflation(0.975, conflated, \"q\") #> [1] 1.964131 # }"},{"path":"https://gaballench.github.io/tbea/reference/stratCI.html","id":null,"dir":"Reference","previous_headings":"","what":"stratCI: Estimate the confidence intervals of endpoints in stratigraphic intervals — stratCI","title":"stratCI: Estimate the confidence intervals of endpoints in stratigraphic intervals — stratCI","text":"stratCI: Estimate confidence intervals endpoints stratigraphic intervals","code":""},{"path":"https://gaballench.github.io/tbea/reference/stratCI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"stratCI: Estimate the confidence intervals of endpoints in stratigraphic intervals — stratCI","text":"","code":"stratCI(times, method, nparams, C, endpoint, confidence, quantile)"},{"path":"https://gaballench.github.io/tbea/reference/stratCI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"stratCI: Estimate the confidence intervals of endpoints in stratigraphic intervals — stratCI","text":"times vector occurrences time want estimate endpoints stratigraphic interval method character describing method use, either 'Strauss-Sadler89' 'Marshall94'. nparams character indicating whether estimate one two parameters, possible values 'one.par' 'two.par'. C numeric indicating confidence level, e.g. 0.95 endpoint used nparams = 'one.par'. Possible values 'first' 'last'. confidence confidence interval level, usually 0.95. quantile desired confidence level quantile representing brackets around confidence interval.","code":""},{"path":"https://gaballench.github.io/tbea/reference/stratCI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"stratCI: Estimate the confidence intervals of endpoints in stratigraphic intervals — stratCI","text":"named vector using 'Strauss-Sadler89' method, unnamed vector using 'Marshall94' method.","code":""},{"path":"https://gaballench.github.io/tbea/reference/stratCI.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"stratCI: Estimate the confidence intervals of endpoints in stratigraphic intervals — stratCI","text":"method='Strauss-Sadler89' need provide `nparams`, `C`, `endpoint`. method='Marshall94' need provide `confidence` `quantile`.","code":""},{"path":"https://gaballench.github.io/tbea/reference/stratCI.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"stratCI: Estimate the confidence intervals of endpoints in stratigraphic intervals — stratCI","text":"Gustavo . Ballen.","code":""},{"path":"https://gaballench.github.io/tbea/reference/stratCI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"stratCI: Estimate the confidence intervals of endpoints in stratigraphic intervals — stratCI","text":"","code":"data(andes) andes <- andes$ages # remove missing data andes <- andes[complete.cases(andes)] # remove outliers andes <- sort(andes[which(andes < 10)]) stratCI(andes, method=\"Strauss-Sadler89\",         nparams=\"one.par\", C=0.95, endpoint=\"first\") #>     minObs     maxObs     maxEst          H     alphaR      alpha  #>  0.2749000  6.9500000  7.4435055 43.0000000  0.4935055  0.0739323  stratCI(andes, method=\"Strauss-Sadler89\",         nparams=\"one.par\", C=0.95, endpoint=\"last\") #>     minEst     minObs     maxObs          H     alphaR      alpha  #> -0.2186055  0.2749000  6.9500000 43.0000000  0.4935055  0.0739323  stratCI(andes, method=\"Strauss-Sadler89\",         nparams=\"two.par\", C=0.95) #>     minEst     minObs     maxObs     maxEst          H     alphaR      alpha  #> -0.3325341  0.2749000  6.9500000  7.5574341 43.0000000  0.6074341  0.0910000  stratCI(andes, method=\"Marshall94\", confidence = 0.95,         quantile = 0.8) #> [1] 7.0701 7.2147 stratCI(andes, method=\"Marshall94\", confidence = 0.95,         quantile = 0.95) #> Warning: Impossible to calculate upper bound #> [1] 7.14   NA"},{"path":"https://gaballench.github.io/tbea/reference/summaryBrlen.html","id":null,"dir":"Reference","previous_headings":"","what":"summaryBrlen: Summarise branch lengths on trees with identical topology — summaryBrlen","title":"summaryBrlen: Summarise branch lengths on trees with identical topology — summaryBrlen","text":"summaryBrlen: Summarise branch lengths trees identical topology","code":""},{"path":"https://gaballench.github.io/tbea/reference/summaryBrlen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"summaryBrlen: Summarise branch lengths on trees with identical topology — summaryBrlen","text":"","code":"summaryBrlen(mphy, method)"},{"path":"https://gaballench.github.io/tbea/reference/summaryBrlen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"summaryBrlen: Summarise branch lengths on trees with identical topology — summaryBrlen","text":"mphy list objects class multiPhylo. single object argument class multiPhylo, first enclosed list. method character function name summary applied","code":""},{"path":"https://gaballench.github.io/tbea/reference/summaryBrlen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"summaryBrlen: Summarise branch lengths on trees with identical topology — summaryBrlen","text":"tree class phylo summary branch lengths tree$edge.length.","code":""},{"path":"https://gaballench.github.io/tbea/reference/summaryBrlen.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"summaryBrlen: Summarise branch lengths on trees with identical topology — summaryBrlen","text":"function can used output topofreq $trees element order summarise branch length topology set single tree summarising topology branch lengths. Useful depicting posterior tree density. Alternatively, can used single element provided first enclosed list","code":""},{"path":"https://gaballench.github.io/tbea/reference/summaryBrlen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"summaryBrlen: Summarise branch lengths on trees with identical topology — summaryBrlen","text":"","code":"# \\donttest{ set.seed(1) library(ape) trl <- ape::rmtree(10, 4) tpf <- topoFreq(unroot(trl), output=\"trees\") sumtrees <- summaryBrlen(tpf$trees, method = \"median\") oldpar <- par(no.readonly = TRUE) par(mfrow=c(1,3)) plot(sumtrees[[1]], type=\"unrooted\", show.node.label=FALSE, cex=1.5) plot(sumtrees[[2]], type=\"unrooted\", show.node.label=FALSE, cex=1.5) plot(sumtrees[[3]], type=\"unrooted\", show.node.label=FALSE, cex=1.5)  par(oldpar) # }"},{"path":"https://gaballench.github.io/tbea/reference/table2nexus.html","id":null,"dir":"Reference","previous_headings":"","what":"table2nexus: Read a data matrix in delimited format and convert into a data matrix in nexus format — table2nexus","title":"table2nexus: Read a data matrix in delimited format and convert into a data matrix in nexus format — table2nexus","text":"table2nexus: Read data matrix delimited format convert data matrix nexus format","code":""},{"path":"https://gaballench.github.io/tbea/reference/table2nexus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"table2nexus: Read a data matrix in delimited format and convert into a data matrix in nexus format — table2nexus","text":"","code":"table2nexus(   path,   datatype = c(\"standard\", \"dna\", \"rna\", \"protein\"),   header = FALSE,   sep = \",\",   con = stdout() )"},{"path":"https://gaballench.github.io/tbea/reference/table2nexus.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"table2nexus: Read a data matrix in delimited format and convert into a data matrix in nexus format — table2nexus","text":"path character vector length 1 path table file. datatype character vector length 1 desired datatype. Possible values STANDARD, DNA, RNA, PROTEIN. Multicharacter types continuous nucleotide supported. header logical vector length 1 indicating whether table file header. Defaults FALSE. sep character vector length 1 telling kind separator table file. Defaults comma \",\". con connection matrix returned. Defaults stdout(), , return text console. writing file, path output file.","code":""},{"path":"https://gaballench.github.io/tbea/reference/table2nexus.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"table2nexus: Read a data matrix in delimited format and convert into a data matrix in nexus format — table2nexus","text":"function writes connected required matrix nexus format morphological dataset (, datatype=standard).","code":""},{"path":"https://gaballench.github.io/tbea/reference/table2nexus.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"table2nexus: Read a data matrix in delimited format and convert into a data matrix in nexus format — table2nexus","text":"function concatenate matrices nexus format (mandatory) write disk output summary information partitions. requires input matrices share taxa positions.","code":""},{"path":"https://gaballench.github.io/tbea/reference/table2nexus.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"table2nexus: Read a data matrix in delimited format and convert into a data matrix in nexus format — table2nexus","text":"Gustavo . Ballen","code":""},{"path":"https://gaballench.github.io/tbea/reference/table2nexus.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"table2nexus: Read a data matrix in delimited format and convert into a data matrix in nexus format — table2nexus","text":"","code":"if (FALSE) { # \\dontrun{ # this will return the matrix to the console rather than to a file table2nexus(path=\"morpho.csv\", datatype=\"standard\", header=FALSE, sep=\",\") } # }"},{"path":"https://gaballench.github.io/tbea/reference/tbea-package.html","id":null,"dir":"Reference","previous_headings":"","what":"tbea: Pre- And Post-Processing in Bayesian Evolutionary Analyses — tbea-package","title":"tbea: Pre- And Post-Processing in Bayesian Evolutionary Analyses — tbea-package","text":"Functions provided prior specification divergence time estimation using fossils well kinds data. provides tools interacting input output Bayesian platforms evolutionary biology 'BEAST2', 'MrBayes', 'RevBayes', 'MCMCTree'. Implements simple measure similarity probability density functions comparing prior posterior Bayesian densities, well code calculating combination distributions using conflation Hill (2008). Functions estimating origination time collections distributions using x-intercept (e.g., Draper Smith, 1998) stratigraphic intervals (Marshall 2010) also available. Hill, T. 2008. \"Conflations probability distributions\". Transactions American Mathematical Society, 363:3351-3372. doi:10.48550/arXiv.0808.1808 , Draper, N. R. Smith, H. 1998. \"Applied Regression Analysis\". 1–706. Wiley Interscience, New York. doi:10.1002/9781118625590 , Marshall, C. R. 2010. \"Using confidence intervals quantify uncertainty end-points stratigraphic ranges\". Quantitative Methods Paleobiology, 291–316. doi:10.1017/S1089332600001911 .","code":""},{"path":[]},{"path":"https://gaballench.github.io/tbea/reference/tbea-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"tbea: Pre- And Post-Processing in Bayesian Evolutionary Analyses — tbea-package","text":"Maintainer: Gustavo . Ballen gustavo..ballen@gmail.com Authors: Sandra Reinales spreinalesl@gmail.com","code":""},{"path":"https://gaballench.github.io/tbea/reference/tnt2newick.html","id":null,"dir":"Reference","previous_headings":"","what":"tnt2newick: Function for converting from TNT tree format to newick parenthetical format — tnt2newick","title":"tnt2newick: Function for converting from TNT tree format to newick parenthetical format — tnt2newick","text":"tnt2newick: Function converting TNT tree format newick parenthetical format","code":""},{"path":"https://gaballench.github.io/tbea/reference/tnt2newick.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"tnt2newick: Function for converting from TNT tree format to newick parenthetical format — tnt2newick","text":"","code":"tnt2newick(   file,   output = NULL,   string = NULL,   return = FALSE,   subsetting = FALSE,   name.sep = NULL )"},{"path":"https://gaballench.github.io/tbea/reference/tnt2newick.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"tnt2newick: Function for converting from TNT tree format to newick parenthetical format — tnt2newick","text":"file vector type 'character' path original TNT tree file. output vector type 'character' path output files contain tree newick format. string vector type 'character' can either object memory string interactive transformation, TNT format. Use file case tree(s) stored file instead. return 'logical' expression indicating whether write newick tree(s) file 'output' (FALSE, default), whether return screen (TRUE), potentially stored vector via '<-' operator. subsetting vector type 'logical' indicating whether subsetting (.e., chopping first last line TNT tree file) done. Otherwise, explicit text replacements removing lines used. default false play well multi-tree TNT files. use subsetting = TRUE sure one tree file commands, tread proc first last lines. name.sep vector length 2 type 'character' carrying separator conversion names terminals. instance, terminals names composed two words separated underscore (_) want separated space ( ) use name.sep = c(\"_\", \" \"). support regular expressions.","code":""},{"path":"https://gaballench.github.io/tbea/reference/tnt2newick.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"tnt2newick: Function for converting from TNT tree format to newick parenthetical format — tnt2newick","text":"function writes disk text file containing tree converted newick format. Alternatively, returns output screen writes object memory thanks argument 'string'.","code":""},{"path":"https://gaballench.github.io/tbea/reference/tnt2newick.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"tnt2newick: Function for converting from TNT tree format to newick parenthetical format — tnt2newick","text":"function tested cases one tree original tnt tree file. Please careful files containing multiple trees.","code":""},{"path":"https://gaballench.github.io/tbea/reference/tnt2newick.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"tnt2newick: Function for converting from TNT tree format to newick parenthetical format — tnt2newick","text":"Gustavo . Ballen","code":""},{"path":"https://gaballench.github.io/tbea/reference/tnt2newick.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"tnt2newick: Function for converting from TNT tree format to newick parenthetical format — tnt2newick","text":"","code":"if (FALSE) { # \\dontrun{ tnt2newick(file = \"someTrees.tre\", return = TRUE) } # }"},{"path":"https://gaballench.github.io/tbea/reference/topoFreq.html","id":null,"dir":"Reference","previous_headings":"","what":"Frequency of topologies in a tree sample — topoFreq","title":"Frequency of topologies in a tree sample — topoFreq","text":"Frequency topologies tree sample","code":""},{"path":"https://gaballench.github.io/tbea/reference/topoFreq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Frequency of topologies in a tree sample — topoFreq","text":"","code":"topoFreq(mphy, output = \"index\", maxtrees = 10000)"},{"path":"https://gaballench.github.io/tbea/reference/topoFreq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Frequency of topologies in a tree sample — topoFreq","text":"mphy object class multiPhylo output character indicating whether tree indices actual trees returned. Defaults \"index\" maxtrees numeric indicating whether warn trees arbitrary threshold","code":""},{"path":"https://gaballench.github.io/tbea/reference/topoFreq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Frequency of topologies in a tree sample — topoFreq","text":"list element containing different tree clusters (multiPhylo) absolute, cumulative, relative frequencies topology tree sample.","code":""},{"path":"https://gaballench.github.io/tbea/reference/topoFreq.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Frequency of topologies in a tree sample — topoFreq","text":"function can used e.w. posterior sample trees Bayesian analysis want explore distribution topologies posterior trees. way can assess topological uncertainty meaningful way using majority-rule consensus. use `maxtrees` actually convenience keeping mind large amounts trees can cause memory issues. can end situations difficult debug personal experience come exactly : trees memory can fit can processed calculating similarity. number _not_ break function call return warning. Try avoid modifying default value unless sure cause issues computing conditions (e.g. lots trees processed also large RAM available).","code":""},{"path":"https://gaballench.github.io/tbea/reference/topoFreq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Frequency of topologies in a tree sample — topoFreq","text":"","code":"# tests set.seed(1) library(ape) trl <- ape::rmtree(10, 4) tpf <- topoFreq(ape::unroot(trl), output=\"trees\")"},{"path":"https://gaballench.github.io/tbea/reference/xintercept.html","id":null,"dir":"Reference","previous_headings":"","what":"xintercept: Estimate the x-intercept of an empirical cdf — xintercept","title":"xintercept: Estimate the x-intercept of an empirical cdf — xintercept","text":"xintercept: Estimate x-intercept empirical cdf","code":""},{"path":"https://gaballench.github.io/tbea/reference/xintercept.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"xintercept: Estimate the x-intercept of an empirical cdf — xintercept","text":"","code":"xintercept(x, method, alpha = 0.05, p = c(0.025, 0.975), R = 1000, robust)"},{"path":"https://gaballench.github.io/tbea/reference/xintercept.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"xintercept: Estimate the x-intercept of an empirical cdf — xintercept","text":"x vector type numeric time data points. method Either \"Draper-Smith\" \"Bootstrap\". function fail otherwise. alpha vector length one type numeric nominal alpha value Draper-Smith method, defaults 0.05. p vector length two type numeric two-tail probability values CI. Defaults 0.025 0.975. R number iterations used Bootstrap method. robust Logical value indicating whether use robust regression using `Rfit::rfit` (`robust = TRUE`) ordinary least squares `lm` (`robust = FALSE`).","code":""},{"path":"https://gaballench.github.io/tbea/reference/xintercept.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"xintercept: Estimate the x-intercept of an empirical cdf — xintercept","text":"named list three elements: `param`, value x_hat; `ci`, lower upper values confidence interval x; `ecdfxy`, x y points empirical cumulative density curve.","code":""},{"path":"https://gaballench.github.io/tbea/reference/xintercept.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"xintercept: Estimate the x-intercept of an empirical cdf — xintercept","text":"function take vector time points, calculate empirical cumulative density function, regress values order infer x-intercept confidence interval. plotting purposes, also return x-y empirical cumulative density values.","code":""},{"path":"https://gaballench.github.io/tbea/reference/xintercept.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"xintercept: Estimate the x-intercept of an empirical cdf — xintercept","text":"Gustavo . Ballen.","code":""},{"path":"https://gaballench.github.io/tbea/reference/xintercept.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"xintercept: Estimate the x-intercept of an empirical cdf — xintercept","text":"","code":"data(andes) ages <- andes$ages ages <- ages[complete.cases(ages)] # remove NAs ages <- ages[which(ages < 10)] # remove outliers  # \\donttest{ # Draper-Smith, OLS draperSmithNormalX0 <- xintercept(x = ages, method = \"Draper-Smith\", alpha = 0.05, robust = FALSE) # Draper-Smith, Robust fit draperSmithRobustX0 <- xintercept(x = ages, method = \"Draper-Smith\", alpha = 0.05, robust = TRUE) # Bootstrap, OLS bootstrapNormalX0 <- xintercept(x = ages, method = \"Bootstrap\", p = c(0.025, 0.975), robust = FALSE) # Bootstrap, Robust fit bootstrapRobustX0 <- xintercept(x = ages, method = \"Bootstrap\", p = c(0.025, 0.975), robust = TRUE) #> Warning: rfit: Convergence status not zero in jaeckel # plot the estimations hist(ages, probability = TRUE, col = rgb(red = 0, green = 0, blue = 1, alpha = 0.3),      xlim = c(0, 10), main = \"CDF-based on confidence intervals\", xlab = \"Age (Ma)\") # plot the lines for the estimator of Draper and Smith using lm arrows(x0 = draperSmithNormalX0$ci[\"upper\"], y0 = 0.025, x1 = draperSmithNormalX0$ci[\"lower\"],        y1 = 0.025, code = 3, angle = 90, length = 0.1, lwd = 3, col = \"darkblue\") # plot the lines for the estimator of Draper and Smith using rfit arrows(x0 = draperSmithRobustX0$ci[\"upper\"], y0 = 0.05, x1 = draperSmithRobustX0$ci[\"lower\"],        y1 = 0.05, code = 3, angle = 90, length = 0.1, lwd = 3, col = \"darkgreen\") # plot the lines for the estimator based on bootstrap arrows(x0 = bootstrapRobustX0$ci[\"upper\"], y0 = 0.075, x1 = bootstrapRobustX0$ci[\"lower\"],        y1 = 0.075, code = 3, angle = 90, length = 0.1, lwd = 3, col = \"darkred\") # plot a legend legend(x = \"topright\", legend = c(\"Draper and Smith with lm\", \"Draper and Smith with rfit\",                                   \"Bootstrap on x0\"),        col = c(\"darkblue\", \"darkgreen\", \"darkred\"),  lty = 1, lwd = 3)  # }"}]
