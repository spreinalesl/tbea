<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>concatNexus: Function for concatenation of nexus matrices both morphological and molecular — concatNexus • tbea</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="concatNexus: Function for concatenation of nexus matrices both morphological and molecular — concatNexus"><meta name="description" content="concatNexus: Function for concatenation of nexus matrices both morphological and molecular"><meta property="og:description" content="concatNexus: Function for concatenation of nexus matrices both morphological and molecular"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tbea</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/concatenation.html">Concatenation</a></li>
    <li><a class="dropdown-item" href="../articles/conflation.html">Conflation of distributions</a></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Introduction to tbea</a></li>
    <li><a class="dropdown-item" href="../articles/l_calibration_mcmctree.html">Specification of the Truncated Cauchy calibration density in MCMCTree</a></li>
    <li><a class="dropdown-item" href="../articles/node_calibration_density.html">Node calibration specification</a></li>
    <li><a class="dropdown-item" href="../articles/posterior_tree_distribution.html">Posterior tree distribution</a></li>
    <li><a class="dropdown-item" href="../articles/prior_posterior_comparisons.html">Prior-Posterior comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/starting_tree.html">Starting trees and how to specify them</a></li>
    <li><a class="dropdown-item" href="../articles/stratigraphic_intervals.html">Stratigraphic intervals</a></li>
    <li><a class="dropdown-item" href="../articles/whyInitVals.html">Why to use the mean of the quantiles as initial values in `optim`?</a></li>
    <li><a class="dropdown-item" href="../articles/x_intercept.html">Inference using x-intercept methods</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gaballench/tbea/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>concatNexus: Function for concatenation of nexus matrices both morphological and molecular</h1>
      <small class="dont-index">Source: <a href="https://github.com/gaballench/tbea/blob/main/R/concatNexus.R" class="external-link"><code>R/concatNexus.R</code></a></small>
      <div class="d-none name"><code>concatNexus.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>concatNexus: Function for concatenation of nexus matrices both morphological and molecular</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">concatNexus</span><span class="op">(</span></span>
<span>  matrices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">pattern</span>,</span>
<span>  <span class="va">path</span>,</span>
<span>  <span class="va">filename</span>,</span>
<span>  morpho <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  morphoFilename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">sumFilename</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-matrices">matrices<a class="anchor" aria-label="anchor" href="#arg-matrices"></a></dt>
<dd><p>A vector of type 'character' with paths to the nexus alignments or their file names. If <code>morphoFilename</code> is non-null, either the path to the morphological partition or its file name must be included too. The default is NULL and it must be defined if none of <code>pattern</code> and <code>path</code> are included.</p></dd>


<dt id="arg-pattern">pattern<a class="anchor" aria-label="anchor" href="#arg-pattern"></a></dt>
<dd><p>A vector of type 'character' and length one containing the text pattern to identify the alignments of interest. It would be tipically be some suffix and/or file extension (see examples).</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>A vector of type 'character' and length one pointing to the directory where the matrices are located. It is used in combination with <code>pattern</code> in order to build a path to each matrix file (see examples).</p></dd>


<dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p>A vector of type 'character' and length one with the file name (or path and file name) for the concatenated output matrix.</p></dd>


<dt id="arg-morpho">morpho<a class="anchor" aria-label="anchor" href="#arg-morpho"></a></dt>
<dd><p>A vector of type 'logical' and length one indicating whether a morphological matrix is included in the concatenation.</p></dd>


<dt id="arg-morphofilename">morphoFilename<a class="anchor" aria-label="anchor" href="#arg-morphofilename"></a></dt>
<dd><p>A vector of type 'character' and length one with the file name or path to the morphological nexus matrix. Needed if <code>morpho = TRUE</code>.</p></dd>


<dt id="arg-sumfilename">sumFilename<a class="anchor" aria-label="anchor" href="#arg-sumfilename"></a></dt>
<dd><p>A vector of type 'character' and length one with the file name or path to the summary information of partition start and end positions. Useful for specifying concatenated analyses in MrBayes where each partition in the matrix might have its own substitution model.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This function writes to the disk two files, one with the concatenated matrix and one with the summary information on partition positions in the complete matrix.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function will concatenate matrices in nexus format (mandatory) and write to the disk the output and summary information on the partitions. It requires that the input matrices all share the same taxa in the same positions.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Gustavo A. Ballen</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Concatenate all the matrices in a given path,</span></span></span>
<span class="r-in"><span><span class="co"># ending with the pattern 'aligned.nex', including a morphological matrix</span></span></span>
<span class="r-in"><span><span class="co"># also defined with a pattern</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="st">"sequences"</span></span></span>
<span class="r-in"><span><span class="va">pattern</span> <span class="op">&lt;-</span> <span class="st">"aligned.nex$"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">concatNexus</span><span class="op">(</span>matrices <span class="op">=</span> <span class="cn">NULL</span>, pattern <span class="op">=</span> <span class="va">pattern</span>,</span></span>
<span class="r-in"><span>            filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">"concatenatedMolmorph.nexus"</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            path <span class="op">=</span> <span class="va">path</span>, </span></span>
<span class="r-in"><span>            morpho <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>            morphoFilename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">path</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"morfologia"</span>,</span></span>
<span class="r-in"><span>                                              x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">path</span>, <span class="va">pattern</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                   sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            sumFilename <span class="op">=</span> <span class="st">"partitions.txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># Concatenate arbitrary matrices in the working directory,</span></span></span>
<span class="r-in"><span><span class="co"># including a morphological matrix, return a concatenated file in the same dir</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">concatNexus</span><span class="op">(</span>matrices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coi.nex"</span>, <span class="st">"rag1.nex"</span>, <span class="st">"cytb.nex"</span>, <span class="st">"morphology.nex"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            filename <span class="op">=</span> <span class="st">"concatenatedMolmorph.nexus"</span>, </span></span>
<span class="r-in"><span>            morpho <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>            morphoFilename <span class="op">=</span> <span class="st">"morphology.nex"</span>,</span></span>
<span class="r-in"><span>            sumFilename <span class="op">=</span> <span class="st">"partitions.txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gustavo A. Ballen, Sandra Reinales.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

