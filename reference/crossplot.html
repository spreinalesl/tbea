<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>crossplot: Plot the mean/median and HPD interval bars for pairs of distributions — crossplot • tbea</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="crossplot: Plot the mean/median and HPD interval bars for pairs of distributions — crossplot"><meta name="description" content="crossplot: Plot the mean/median and HPD interval bars for pairs of distributions"><meta property="og:description" content="crossplot: Plot the mean/median and HPD interval bars for pairs of distributions"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tbea</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/concatenation.html">Concatenation</a></li>
    <li><a class="dropdown-item" href="../articles/conflation.html">Conflation of distributions</a></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Introduction to tbea</a></li>
    <li><a class="dropdown-item" href="../articles/l_calibration_mcmctree.html">Specification of the Truncated Cauchy calibration density in MCMCTree</a></li>
    <li><a class="dropdown-item" href="../articles/node_calibration_density.html">Node calibration specification</a></li>
    <li><a class="dropdown-item" href="../articles/posterior_tree_distribution.html">Posterior tree distribution</a></li>
    <li><a class="dropdown-item" href="../articles/prior_posterior_comparisons.html">Prior-Posterior comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/starting_tree.html">Starting trees and how to specify them</a></li>
    <li><a class="dropdown-item" href="../articles/stratigraphic_intervals.html">Stratigraphic intervals</a></li>
    <li><a class="dropdown-item" href="../articles/whyInitVals.html">Why to use the mean of the quantiles as initial values in `optim`?</a></li>
    <li><a class="dropdown-item" href="../articles/x_intercept.html">Inference using x-intercept methods</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gaballench/tbea/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>crossplot: Plot the mean/median and HPD interval bars for pairs of distributions</h1>
      <small class="dont-index">Source: <a href="https://github.com/gaballench/tbea/blob/main/R/crossplot.R" class="external-link"><code>R/crossplot.R</code></a></small>
      <div class="d-none name"><code>crossplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>crossplot: Plot the mean/median and HPD interval bars for pairs of distributions</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">crossplot</span><span class="op">(</span></span>
<span>  <span class="va">log1</span>,</span>
<span>  <span class="va">log2</span>,</span>
<span>  skip.char <span class="op">=</span> <span class="st">"#"</span>,</span>
<span>  pattern <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stat <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>  idx.cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">bar.lty</span>,</span>
<span>  <span class="va">bar.lwd</span>,</span>
<span>  <span class="va">identity.lty</span>,</span>
<span>  <span class="va">identity.lwd</span>,</span>
<span>  extra.space <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-log-">log1<a class="anchor" aria-label="anchor" href="#arg-log-"></a></dt>
<dd><p>either a character vector of length 1 with the path to the first
log file (e.g. prior node ages), or a dataframe with independent samples as rows
and values to compare as columns (e.g. node IDs).</p></dd>


<dt id="arg-log-">log2<a class="anchor" aria-label="anchor" href="#arg-log-"></a></dt>
<dd><p>either a character vector of length 1 with the path to the second
log file (e.g. posterior node ages), or a dataframe with independent samples as rows
and values to compare as columns (e.g. node IDs).</p></dd>


<dt id="arg-skip-char">skip.char<a class="anchor" aria-label="anchor" href="#arg-skip-char"></a></dt>
<dd><p>character vector of length 1, with '#' as default value.
Which symbol is used as a comment. This will allow to ignore lines which
start with the symbol when reading data.</p></dd>


<dt id="arg-pattern">pattern<a class="anchor" aria-label="anchor" href="#arg-pattern"></a></dt>
<dd><p>character vector of length 1. the pattern for subsetting the
columns containing the data to be plotted.</p></dd>


<dt id="arg-stat">stat<a class="anchor" aria-label="anchor" href="#arg-stat"></a></dt>
<dd><p>use mean or median of the distribution to plot. Median is used by default.</p></dd>


<dt id="arg-idx-cols">idx.cols<a class="anchor" aria-label="anchor" href="#arg-idx-cols"></a></dt>
<dd><p>either an integer vector with the position of the columns to
pick, or a character vector with the column names to pick. Defaults to NULL.</p></dd>


<dt id="arg-bar-lty">bar.lty<a class="anchor" aria-label="anchor" href="#arg-bar-lty"></a></dt>
<dd><p>The line type to be used as error bars.</p></dd>


<dt id="arg-bar-lwd">bar.lwd<a class="anchor" aria-label="anchor" href="#arg-bar-lwd"></a></dt>
<dd><p>As above but the width</p></dd>


<dt id="arg-identity-lty">identity.lty<a class="anchor" aria-label="anchor" href="#arg-identity-lty"></a></dt>
<dd><p>The line type to be used in
the identity y = x line</p></dd>


<dt id="arg-identity-lwd">identity.lwd<a class="anchor" aria-label="anchor" href="#arg-identity-lwd"></a></dt>
<dd><p>As above but the width.</p></dd>


<dt id="arg-extra-space">extra.space<a class="anchor" aria-label="anchor" href="#arg-extra-space"></a></dt>
<dd><p>numeric vector of length 1. How much space to be allowed
in both xlim and ylim depending on the smallest value in highest density
intervals plus or minus extra.space. A value of 0.5 units on the dimension
of interest is used by default.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Optional arguments to be passed to `plot` such as `main`, `xlab`,
`ylab`, `pch` and `cex`.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This function returns nothing, it plots to the graphical device.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function produces a crossplot, which is a scatterplot where we
are comparing two distributions associated to each point by means of the
medians as the points, and the highest density intervals as bars around the
point. For instance, x may represent the prior of a set of parameters while
y represents the posterior. Error bars on the x axis then are highest density
intervals from the prior, and those on the y axis represent the interval for
the posterior.</p>
<p>This function can also be used to compare two independent runs for
(visual) convergence: If they are sampling the same posterior distribution,
then they should fall on the identity y=x line.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Gustavo A. Ballen and Sandra Reinales</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Create log dataframes</span></span></span>
<span class="r-in"><span><span class="va">log1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">1</span>, to<span class="op">=</span><span class="fl">10000</span>, by <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   node1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">41</span>, sd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   node2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">50</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   node3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">25</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">log2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">1</span>, to<span class="op">=</span><span class="fl">10000</span>, by <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   node1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">41</span>, sd<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   node2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">50</span>, sd<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   node3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">25</span>, sd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                   </span></span>
<span class="r-in"><span><span class="co">## Run crossplot</span></span></span>
<span class="r-in"><span><span class="fu">crossplot</span><span class="op">(</span><span class="va">log1</span>, <span class="va">log2</span>, pattern<span class="op">=</span><span class="st">"node"</span>, cols<span class="op">=</span><span class="cn">NULL</span>, stat<span class="op">=</span><span class="st">"mean"</span>,</span></span>
<span class="r-in"><span>          bar.lty<span class="op">=</span><span class="fl">1</span>, bar.lwd<span class="op">=</span><span class="fl">1</span>, identity.lty<span class="op">=</span><span class="fl">2</span>, identity.lwd<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>          extra.space<span class="op">=</span><span class="fl">0.5</span>, main<span class="op">=</span><span class="st">"My plot"</span>, xlab<span class="op">=</span><span class="st">"log 1 (prior)"</span>,</span></span>
<span class="r-in"><span>          ylab<span class="op">=</span><span class="st">"log 2 (posterior)"</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="crossplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## Run crossplot over log files</span></span></span>
<span class="r-in"><span><span class="fu">crossplot</span><span class="op">(</span>log1<span class="op">=</span><span class="st">"log1.tsv"</span>, log2<span class="op">=</span><span class="st">"log2.tsv"</span>, stat<span class="op">=</span><span class="st">"median"</span>, skip.char<span class="op">=</span><span class="st">"#"</span>,</span></span>
<span class="r-in"><span>          pattern<span class="op">=</span><span class="st">"par"</span>, cols<span class="op">=</span><span class="cn">NULL</span>, bar.lty<span class="op">=</span><span class="fl">1</span>, bar.lwd<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>          identity.lty<span class="op">=</span><span class="fl">2</span>, identity.lwd<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>          extra.space<span class="op">=</span><span class="fl">0.5</span>, main<span class="op">=</span><span class="st">"My plot"</span>, xlab<span class="op">=</span><span class="st">"log 1 (prior)"</span>,</span></span>
<span class="r-in"><span>          ylab<span class="op">=</span><span class="st">"log 2 (posterior)"</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gustavo A. Ballen, Sandra Reinales.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

