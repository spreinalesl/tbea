<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Inference using x-intercept methods • tbea</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Inference using x-intercept methods">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tbea</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/concatenation.html">Concatenation</a></li>
    <li><a class="dropdown-item" href="../articles/conflation.html">Conflation of distributions</a></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Introduction to tbea</a></li>
    <li><a class="dropdown-item" href="../articles/l_calibration_mcmctree.html">Specification of the Truncated Cauchy calibration density in MCMCTree</a></li>
    <li><a class="dropdown-item" href="../articles/node_calibration_density.html">Node calibration specification</a></li>
    <li><a class="dropdown-item" href="../articles/posterior_tree_distribution.html">Posterior tree distribution</a></li>
    <li><a class="dropdown-item" href="../articles/prior_posterior_comparisons.html">Prior-Posterior comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/starting_tree.html">Starting trees and how to specify them</a></li>
    <li><a class="dropdown-item" href="../articles/stratigraphic_intervals.html">Stratigraphic intervals</a></li>
    <li><a class="dropdown-item" href="../articles/whyInitVals.html">Why to use the mean of the quantiles as initial values in `optim`?</a></li>
    <li><a class="dropdown-item" href="../articles/x_intercept.html">Inference using x-intercept methods</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gaballench/tbea/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Inference using x-intercept methods</h1>
                        <h4 data-toc-skip class="author">Gustavo A.
Ballen and Sandra Reinales</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gaballench/tbea/blob/main/vignettes/x_intercept.Rmd" class="external-link"><code>vignettes/x_intercept.Rmd</code></a></small>
      <div class="d-none name"><code>x_intercept.Rmd</code></div>
    </div>

    
    
<p>These approaches are based on the assumption that the cumulative the
pattern of appearance of divergence time events from an unknown time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>0</mn></msub><annotation encoding="application/x-tex">t_0</annotation></semantics></math>
onwards can inform on the event time. A regression model with an
additional parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-intercept
may be thought of as an estimator for such point in time given the trend
present in the linear model. Estimation of uncertainty regions such as
confidence intervals on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-intercept
can be even more useful than the point estimate itself; such regions can
be constructed by fitting an empirical cumulative density function.</p>
<p>Events in time start at some unobserved point and their realisations
continue until the process finishes. Because they are delayed by some
quantity after the generator process starts, we can use the pattern of
occurrence in time in order to estimate the origination time. They can
be described as a distribution regardless of its generator process,
which will follow a probability density function (PDF)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(t)</annotation></semantics></math>,
with an associated cumulative density function (CDF)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>&lt;</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(X &lt; x)</annotation></semantics></math>.
We can fit an empirical CDF and then use a linear regression model. The
only case where a CDF would be truly linear would be in the case of a
uniform distribution where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>≤</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>x</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mrow><mspace width="0.222em"></mspace><mi mathvariant="normal">f</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi><mspace width="0.222em"></mspace></mrow><mi>x</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">P(X \leq x) = \frac{x}{b - a} \mathrm{\ for\ } x \in [a,b]</annotation></semantics></math>
which implies that the empirical data in time follow a uniform
distribution. For any other case, a fitted CDF would be a non-linear,
and thus a linearisation should be applied to it.</p>
<p>There are several methods available for linearising data (e.g.,
applying the logarithm, the square and cubic roots, the arcsine, or the
reciprocal to the raw data). In the case of CDF fitting, we need to
guarantee that the data are linear regardless of the PDF in order to
estimate parameters of the model and thus the procedure is appropriate.
After model fitting, a back transformation would be necessary for
representing the time value of interest in real space.</p>
<p>The linear model has the form
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>m</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">y = m x + b</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
is the slope and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>-intercept.
However, we are not interested in any of these parameters but instead in
a third one, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-intercept,
that is defined as the point in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y = 0</annotation></semantics></math>.
This parameter can be defined by letting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y = 0</annotation></semantics></math>
in the equation and thus
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow></msub><mo>=</mo><mo>−</mo><mfrac><mi>b</mi><mi>m</mi></mfrac></mrow><annotation encoding="application/x-tex">x_{y = 0} = -\frac{b}{m}</annotation></semantics></math>
allows us to find the point at which the data began to be generated.</p>
<p>Several methods have been proposed for estimating the uncertainty on
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-intercept
estimate, from the intuitive inverse regression
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>∼</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \sim Y</annotation></semantics></math>
to bootstraping methods. According to Seber and Lee (2013)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Seber, G.A.F. and Lee, A.J. (2013). Linear Regression
Analysis. Wiley Interscience, Hoboken, NJ, 2nd edition.&lt;/p&gt;"><sup>1</sup></a> this problem has long
been discussed in the statistical literature without much consensus,
although some are of interest due to theoretical appeal, ease of
implementation, or simplification of assumptions. Uncertainty on the
estimate of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-intercept
can be obtained through Taylor series simplification
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>σ</mi><mi>X</mi></msub><mi>X</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>σ</mi><mi>a</mi></msub><mi>a</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>σ</mi><mi>b</mi></msub><mi>b</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>+</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>σ</mi><mi>a</mi></msub><mi>a</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>σ</mi><mi>b</mi></msub><mi>b</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ρ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\left(\frac{\sigma_X}{X}\right)^2 = \left(\frac{\sigma_a}{a}\right)^2 + \left(\frac{\sigma_b}{b}\right)^2 + 2 \left(\frac{\sigma_a}{a}\right) \left(\frac{\sigma_b}{b}\right) \rho_{ab}</annotation></semantics></math>
for symmetric intervals.</p>
<p>Another approach by Draper and Smith (1998)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Draper, N.R. and Smith, H. (1998). Applied Regression
Analysis. Wiley Interscience, New York.&lt;/p&gt;"><sup>2</sup></a> allows the calculation
asymmetric confidence intervals by projecting the values of the
confidence region around the linear model on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-axis
by manipulation of the curves describing the confidence region, what
gives
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>I</mi><msub><mi>X</mi><mn>0</mn></msub></msub><mo>=</mo><mover><msub><mi>X</mi><mn>0</mn></msub><mo accent="true">̂</mo></mover><mo>+</mo><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>0</mn></msub><mo>−</mo><mover><mi>X</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mi>g</mi><mo>±</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mi>s</mi><mi>/</mi><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="false" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><msub><mi>X</mi><mn>0</mn></msub><mo accent="true">̂</mo></mover><mo>−</mo><mover><mi>X</mi><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><msub><mi>S</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>g</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>n</mi><mo stretchy="false" form="postfix">}</mo></mrow><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup></mrow><mrow><mn>1</mn><mo>−</mo><mi>g</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">CI_{X_{0}} = \hat{X_0} + \frac{(X_0 - \bar{X}) g \pm (t s / b_1) {\{[{(\hat{X_0} - \bar{X})}^2 S_{XX}] + (1 - g) / n\}}^{1/2}}{1 - g}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><msup><mi>t</mi><mn>2</mn></msup><msup><mi>s</mi><mn>2</mn></msup><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>b</mi><mn>1</mn><mn>2</mn></msubsup><mi>/</mi><msub><mi>S</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g = t^2 s^2 / (b_1^2 / {S_{XX}})</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mn>1</mn></msub><annotation encoding="application/x-tex">b_1</annotation></semantics></math>
is the slope,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mrow><mi>X</mi><mi>X</mi></mrow></msub><annotation encoding="application/x-tex">S_{XX}</annotation></semantics></math>
is the sum of squares of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-statistic
with n-2 degrees of freedom and at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1 - \alpha/2</annotation></semantics></math>
significance level,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mn>2</mn></msup><annotation encoding="application/x-tex">s^2</annotation></semantics></math>
is the standard deviation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><msub><mi>X</mi><mn>0</mn></msub><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{X_0}</annotation></semantics></math>
is the estimation of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-intercept,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>X</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{X}</annotation></semantics></math>
is the mean of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>.
Here we need to fit a linear model in order to use the curves for the
confidence region, and we can use classical least square models or
robust non-parametric regression Kloke and McKean (2014)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Kloke, J.D. and McKean, J.W. (2012). Rfit: Rank-based
estimation for linear models. The R Journal, 4(2):57-64.&lt;/p&gt;"><sup>3</sup></a>.</p>
<p>It is also possible to use bootstrapping in order to estimate the
variance and thus the confidence interval in asymmetric cases such as
this one. Instead of using the estimates from a single fitted model on
the coordinates of the empirical CDF, this method fits multiple models
with random subsamples in order to construct a collection of estimated
values the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-intercept
and this provides a confidence interval.</p>
<p>The package <code>tbea</code> implements estimation of the confidence
interval for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>−</mo></mrow><annotation encoding="application/x-tex">x-</annotation></semantics></math>intercept
using the method of Draper and Smith (1998) as well as estimation via
bootstrap. Both require a linear model which can be set to one of the
following: either ordinary least squares, or a robust linear model Kloke
and McKean (2014).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gaballench/tbea" class="external-link">tbea</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">andes</span><span class="op">)</span></span>
<span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="va">andes</span><span class="op">$</span><span class="va">ages</span></span>
<span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="va">ages</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">ages</span><span class="op">)</span><span class="op">]</span> <span class="co"># remove NAs</span></span>
<span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="va">ages</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ages</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="co"># remove outliers</span></span>
<span></span>
<span><span class="co"># Draper-Smith, OLS</span></span>
<span><span class="va">draperSmithNormalX0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xintercept.html">xintercept</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ages</span>, method<span class="op">=</span><span class="st">"Draper-Smith"</span>,</span>
<span>                                  alpha<span class="op">=</span><span class="fl">0.05</span>, robust<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Draper-Smith, Robust fit</span></span>
<span><span class="va">draperSmithRobustX0</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/xintercept.html">xintercept</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ages</span>, method<span class="op">=</span><span class="st">"Draper-Smith"</span>,</span>
<span>                                 alpha<span class="op">=</span><span class="fl">0.05</span>, robust<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># bootstrap, OLS</span></span>
<span><span class="va">bootstrapNormalX0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xintercept.html">xintercept</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ages</span>, method<span class="op">=</span><span class="st">"Bootstrap"</span>,</span>
<span>                                p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, robust<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># bootstrap, Robust fit</span></span>
<span><span class="va">bootstrapRobustX0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xintercept.html">xintercept</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ages</span>, method<span class="op">=</span><span class="st">"Bootstrap"</span>,</span>
<span>                                p<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, robust<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the estimations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ages</span>, probability<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>     col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span>red<span class="op">=</span><span class="fl">0</span>, green<span class="op">=</span><span class="fl">0</span>, blue<span class="op">=</span><span class="fl">1</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span>,</span>
<span>     xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"CDF-based on confidence intervals"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Age (Ma)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the lines for the estimator of Draper and Smith using lm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span>x0<span class="op">=</span><span class="va">draperSmithNormalX0</span><span class="op">$</span><span class="va">ci</span><span class="op">[</span><span class="st">"upper"</span><span class="op">]</span>, y0<span class="op">=</span><span class="fl">0.025</span>,</span>
<span>       x1<span class="op">=</span><span class="va">draperSmithNormalX0</span><span class="op">$</span><span class="va">ci</span><span class="op">[</span><span class="st">"lower"</span><span class="op">]</span>, y1<span class="op">=</span><span class="fl">0.025</span>,</span>
<span>       code<span class="op">=</span><span class="fl">3</span>, angle<span class="op">=</span><span class="fl">90</span>, length<span class="op">=</span><span class="fl">0.1</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"darkblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the lines for the estimator of Draper and Smith using rfit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span>x0<span class="op">=</span><span class="va">draperSmithRobustX0</span><span class="op">$</span><span class="va">ci</span><span class="op">[</span><span class="st">"upper"</span><span class="op">]</span>, y0<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>       x1<span class="op">=</span><span class="va">draperSmithRobustX0</span><span class="op">$</span><span class="va">ci</span><span class="op">[</span><span class="st">"lower"</span><span class="op">]</span>, y1<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>       code<span class="op">=</span><span class="fl">3</span>, angle<span class="op">=</span><span class="fl">90</span>, length<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>       lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"darkgreen"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the lines for the estimator based on bootstrap</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span>x0<span class="op">=</span><span class="va">bootstrapRobustX0</span><span class="op">$</span><span class="va">ci</span><span class="op">[</span><span class="st">"upper"</span><span class="op">]</span>, y0<span class="op">=</span><span class="fl">0.075</span>,</span>
<span>       x1<span class="op">=</span><span class="va">bootstrapRobustX0</span><span class="op">$</span><span class="va">ci</span><span class="op">[</span><span class="st">"lower"</span><span class="op">]</span>, y1<span class="op">=</span><span class="fl">0.075</span>,</span>
<span>       code<span class="op">=</span><span class="fl">3</span>, angle<span class="op">=</span><span class="fl">90</span>, length<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>       lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"darkred"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot a legend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"topright"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Draper and Smith with lm"</span>,</span>
<span>                              <span class="st">"Draper and Smith with rfit"</span>,</span>
<span>                              <span class="st">"Bootstrap on x0"</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkblue"</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkred"</span><span class="op">)</span>,</span>
<span>       lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="x_intercept_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>Both methods produce similar results. Although the method based on
robust regression produced a CI wider than the one based on ordinary
least squares, the bootstrap CI estimate was as wide as the two former
combined. The fact that the bootstraping based on robust estimates is of
more general application, it seems more adequate for these situations.
It is noteworthy that these inferences are based on the assumption that
the events in time are measured without error. However, this assumption
relaxes due to the effect of re-sampling and uncertainty in the
estimates. According to both estimators, the separation between cis- and
trans-Andean areas took place between ca.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4.3</mn><mo>−</mo><mn>5.8</mn></mrow><annotation encoding="application/x-tex">4.3-5.8</annotation></semantics></math>
Ma.</p>
<p>These methods have produced results in line with those based on
stratigraphic intervals. However, they allow estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-intercepts
and consequently their confidence intervals that are not necessarily
older than the oldest divergence time estimation event. Thus, they are
robust to the assumption of measurement without error that is implicit
in stratigraphic interval methods. Nevertheless, they are still
sensitive to the presence of strong outliers as preliminary analyses
showed that the regressions on these data with outliers affected
strongly the robust regressions.</p>

  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gustavo A. Ballen, Sandra Reinales.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
