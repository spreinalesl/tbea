<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Prior-Posterior comparisons â€¢ tbea</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prior-Posterior comparisons">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tbea</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/concatenation.html">Concatenation</a></li>
    <li><a class="dropdown-item" href="../articles/conflation.html">Conflation of distributions</a></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Introduction to tbea</a></li>
    <li><a class="dropdown-item" href="../articles/l_calibration_mcmctree.html">Specification of the Truncated Cauchy calibration density in MCMCTree</a></li>
    <li><a class="dropdown-item" href="../articles/node_calibration_density.html">Node calibration specification</a></li>
    <li><a class="dropdown-item" href="../articles/posterior_tree_distribution.html">Posterior tree distribution</a></li>
    <li><a class="dropdown-item" href="../articles/prior_posterior_comparisons.html">Prior-Posterior comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/starting_tree.html">Starting trees and how to specify them</a></li>
    <li><a class="dropdown-item" href="../articles/stratigraphic_intervals.html">Stratigraphic intervals</a></li>
    <li><a class="dropdown-item" href="../articles/whyInitVals.html">Why to use the mean of the quantiles as initial values in `optim`?</a></li>
    <li><a class="dropdown-item" href="../articles/x_intercept.html">Inference using x-intercept methods</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gaballench/tbea/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prior-Posterior comparisons</h1>
                        <h4 data-toc-skip class="author">Gustavo A.
Ballen and Sandra Reinales</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gaballench/tbea/blob/main/vignettes/prior_posterior_comparisons.Rmd" class="external-link"><code>vignettes/prior_posterior_comparisons.Rmd</code></a></small>
      <div class="d-none name"><code>prior_posterior_comparisons.Rmd</code></div>
    </div>

    
    
<p>After carrying out a divergence time analysis with
<code>Beast2</code>, for example, we might be interested in comparing
the prior and the posterior of node ages. We can use the function
<code>crossplot</code> to generate a plot where the x-axis represents
one analysis and the y-axis another, for instance, prior versus
posterior:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gaballench/tbea" class="external-link">tbea</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># crossplot operates over files or dataframes. Let's create</span></span>
<span><span class="co"># two dataframes to exemplified the desirable structure of input data</span></span>
<span></span>
<span><span class="va">log1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">1</span>, to<span class="op">=</span><span class="fl">10000</span>, by <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                   node1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">41</span>, sd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                   node2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">50</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                   node3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">25</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span> </span>
<span><span class="va">log2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sample<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">1</span>, to<span class="op">=</span><span class="fl">10000</span>, by <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                   node1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">41</span>, sd<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span>,</span>
<span>                   node2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">50</span>, sd<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span>,</span>
<span>                   node3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">100</span>, mean<span class="op">=</span><span class="fl">25</span>, sd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">log1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   sample    node1    node2    node3</span></span>
<span><span class="co">## 1      1 40.29998 49.61279 24.57062</span></span>
<span><span class="co">## 2    101 41.12766 49.21457 26.36046</span></span>
<span><span class="co">## 3    201 39.78137 48.94326 24.92914</span></span>
<span><span class="co">## 4    301 40.99721 49.20446 24.72785</span></span>
<span><span class="co">## 5    401 41.31078 48.24372 22.55332</span></span>
<span><span class="co">## 6    501 41.57421 49.30946 25.06549</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run crossplot over nodes 1 and 2 using 'idx.cols' instead of 'pattern', and</span></span>
<span><span class="co"># plot the mean instead of the median.</span></span>
<span><span class="fu"><a href="../reference/crossplot.html">crossplot</a></span><span class="op">(</span><span class="va">log1</span>, <span class="va">log2</span>,</span>
<span>          idx.cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>          stat<span class="op">=</span><span class="st">"mean"</span>,</span>
<span>          bar.lty<span class="op">=</span><span class="fl">1</span>,</span>
<span>          bar.lwd<span class="op">=</span><span class="fl">1</span>,</span>
<span>          identity.lty<span class="op">=</span><span class="fl">2</span>,</span>
<span>          identity.lwd<span class="op">=</span><span class="fl">1</span>,</span>
<span>          extra.space<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>          main<span class="op">=</span><span class="st">"My first crossplot"</span>,</span>
<span>          xlab<span class="op">=</span><span class="st">"log 1"</span>,</span>
<span>          ylab<span class="op">=</span><span class="st">"log 2"</span>,</span>
<span>          pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<p><img src="prior_posterior_comparisons_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># now, load empirical data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cynodontidae.prior</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cynodontidae.posterior</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># as crossplot operates also over files, let's create temporal</span></span>
<span><span class="co"># files for illustration</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">cynodontidae.prior</span>, <span class="st">"prior.tsv"</span>,</span>
<span>            row.names<span class="op">=</span><span class="cn">FALSE</span>, col.names<span class="op">=</span><span class="cn">TRUE</span>, sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">cynodontidae.posterior</span>, <span class="st">"posterior.tsv"</span>,</span>
<span>            row.names<span class="op">=</span><span class="cn">FALSE</span>, col.names<span class="op">=</span><span class="cn">TRUE</span>, sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># crossplot</span></span>
<span><span class="fu"><a href="../reference/crossplot.html">crossplot</a></span><span class="op">(</span>log1<span class="op">=</span><span class="st">"prior.tsv"</span>,</span>
<span>          log2<span class="op">=</span><span class="st">"posterior.tsv"</span>,</span>
<span>          stat<span class="op">=</span><span class="st">"median"</span>,</span>
<span>          skip.char<span class="op">=</span><span class="st">"#"</span>,</span>
<span>          pattern<span class="op">=</span><span class="st">"mrca.date"</span>,</span>
<span>          bar.lty<span class="op">=</span><span class="fl">1</span>,</span>
<span>          bar.lwd<span class="op">=</span><span class="fl">2</span>,</span>
<span>          identity.lty<span class="op">=</span><span class="fl">2</span>,</span>
<span>          identity.lwd<span class="op">=</span><span class="fl">2</span>,</span>
<span>          main<span class="op">=</span><span class="st">"Prior-posterior comparison\nCynodontidae"</span>,</span>
<span>          xlab<span class="op">=</span><span class="st">"Prior node age (Ma)"</span>,</span>
<span>          ylab<span class="op">=</span><span class="st">"Posterior node age (Ma)"</span>,</span>
<span>          pch<span class="op">=</span><span class="fl">20</span>, cex<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"blue2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="prior_posterior_comparisons_files/figure-html/unnamed-chunk-1-2.png" width="700"></p>
<p>This kind of plot has been used in the literature when comparing
prior and posterior MCMC samples, as well as when comparing the same
kind of estimates coming from different independent runs or types of
analysis. The function <code>measureSimil</code> integrates the area
under the curve defined as the intersection between both distributions.
It is a descriptive measure of how similar two distributions are. The
function can both plot the resulting distributions and their
intersection, as well as print out its value, or skip the plot and just
return the value:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># integrate the area under the curve</span></span>
<span><span class="fu"><a href="../reference/measureSimil.html">measureSimil</a></span><span class="op">(</span>d1<span class="op">=</span><span class="va">cynodontidae.prior</span><span class="op">$</span><span class="va">mrca.date.backward.Hydrolycus.</span>,</span>
<span>             d2<span class="op">=</span><span class="va">cynodontidae.posterior</span><span class="op">$</span><span class="va">mrca.date.backward.Hydrolycus.</span>,</span>
<span>             ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>             xlab<span class="op">=</span><span class="st">"Age (Ma)"</span>,</span>
<span>             ylab<span class="op">=</span><span class="st">"Density"</span>,</span>
<span>             main<span class="op">=</span><span class="st">"Similarity between prior and posterior\nof the node Hydrolycus"</span><span class="op">)</span></span></code></pre></div>
<p><img src="prior_posterior_comparisons_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<pre><code><span><span class="co">## [1] 0.8078552</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># file cleanup</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="st">"prior.tsv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="st">"posterior.tsv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gustavo A. Ballen, Sandra Reinales.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
