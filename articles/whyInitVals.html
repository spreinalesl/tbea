<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Why to use the mean of the quantiles as initial values in `optim`? â€¢ tbea</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Why to use the mean of the quantiles as initial values in `optim`?">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tbea</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/concatenation.html">Concatenation</a></li>
    <li><a class="dropdown-item" href="../articles/conflation.html">Conflation of distributions</a></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Introduction to tbea</a></li>
    <li><a class="dropdown-item" href="../articles/l_calibration_mcmctree.html">Specification of the Truncated Cauchy calibration density in MCMCTree</a></li>
    <li><a class="dropdown-item" href="../articles/node_calibration_density.html">Node calibration specification</a></li>
    <li><a class="dropdown-item" href="../articles/posterior_tree_distribution.html">Posterior tree distribution</a></li>
    <li><a class="dropdown-item" href="../articles/prior_posterior_comparisons.html">Prior-Posterior comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/starting_tree.html">Starting trees and how to specify them</a></li>
    <li><a class="dropdown-item" href="../articles/stratigraphic_intervals.html">Stratigraphic intervals</a></li>
    <li><a class="dropdown-item" href="../articles/whyInitVals.html">Why to use the mean of the quantiles as initial values in `optim`?</a></li>
    <li><a class="dropdown-item" href="../articles/x_intercept.html">Inference using x-intercept methods</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gaballench/tbea/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Why to use the mean of the quantiles as initial values in `optim`?</h1>
                        <h4 data-toc-skip class="author">Gustavo A.
Ballen</h4>
            
            <h4 data-toc-skip class="date">2025-08-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gaballench/tbea/blob/main/vignettes/whyInitVals.Rmd" class="external-link"><code>vignettes/whyInitVals.Rmd</code></a></small>
      <div class="d-none name"><code>whyInitVals.Rmd</code></div>
    </div>

    
    
<p>One issue with the use of the <code>optim</code> function for
parameter approximation from a ser of percentiles and quantiles is that
it requires initial values for its heuristic search of values. If these
initial values are much distant from the unknown real parameter value,
then the function has serious problems with convergence and may produce
results that are simply wrong. In pre-release versions of
<code>findParams</code> the initial value was a vector of
<code>1</code>s corresponding to the number of parameters to estimate
(e.g., <code>c(1, 1)</code> when estimating <code>mean</code> and
<code>sd</code> in <code>pnorm</code>), but this produced simply wrong
results when, for instance, the real <code>mean</code> was 10 or a
larger value.</p>
<p>With a little help of simulation we can show that the best initial
guess is in fact the mean of the quantiles.</p>
<p>the following code will generate a lot of parameter estimates from
several trials using different initial values. With a bit of large
number theory, a decent estimate can be found. Here, <code>q</code> and
<code>p</code> are quantiles and percentiles under a given, known
distribution; a different anonymous function where sapply varies the
values of the initial values allows to get the <code>$par</code> element
of the <code>optim</code> call, and the the density plot shows that
overall a mean estimate approaches at the correct value. The values of
<code>q</code> come from qDIST given the probabilities of interest
(generally 0.025, 0.5, and 0.975). For instance: qbeta(p = c(0.05, 0.5,
0.95), shape1 = 10, shape2 = 1) for the example below:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># X = seq... is the set of values to try, from min(q) to max(q). </span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.6915029</span>, <span class="fl">0.9974714</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>                     FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>                         <span class="fu">findParamsPrototype</span><span class="op">(</span>q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6915029</span>, <span class="fl">0.9330330</span>, <span class="fl">0.9974714</span><span class="op">)</span>,</span>
<span>                                    p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>                                    densit <span class="op">=</span> <span class="st">"pbeta"</span>,</span>
<span>                                    params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shape1"</span>, <span class="st">"shape2"</span><span class="op">)</span>,</span>
<span>                                    initVals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">par</span></span>
<span>                     <span class="op">}</span>,</span>
<span>                     simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Density for shape1"</span>, xlab <span class="op">=</span> <span class="st">"Shape1"</span>, ylab <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="whyInitVals_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Density for shape2"</span>, xlab <span class="op">=</span> <span class="st">"Shape2"</span>, ylab <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="whyInitVals_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<p>Large number theory allow us to expect such result, but, what if the
specific initial value matters? Another simulation plotting the
parameter value as a function of the initial value can be prepared with,
say, a random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mspace width="0.222em"></mspace><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¼</mi><mo>=</mo><mn>10</mn><mo>,</mo><mi>Ïƒ</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X ~ N(\mu = 10, \sigma = 1)</annotation></semantics></math>.
Such a large mean is expected to cause problems with initial values,
since in these simulations 10 is huge when compared to 1. Initial values
were simulated to take values between 0.001 and 10 because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïƒ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma &gt; 0</annotation></semantics></math>
so zero and negative values would break the code.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check that quantiles are rigth:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  8.040036 10.000000 11.959964</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate the parameters</span></span>
<span><span class="va">simInitVals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="va">parameters2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">simInitVals</span>,</span>
<span>                     FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>                         <span class="fu">findParamsPrototype</span><span class="op">(</span>q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8.040036</span>, <span class="fl">10.000000</span>, <span class="fl">11.959964</span><span class="op">)</span>,</span>
<span>                                    p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>                                    densit <span class="op">=</span> <span class="st">"pnorm"</span>,</span>
<span>                                    params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span>,</span>
<span>                                    initVals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">par</span></span>
<span>                     <span class="op">}</span>,</span>
<span>                     simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">parameters2</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, x <span class="op">=</span> <span class="va">simInitVals</span>, main <span class="op">=</span> <span class="st">"Estimates for the mean"</span>, xlab <span class="op">=</span> <span class="st">"Simulated init. vals."</span>, ylab <span class="op">=</span> <span class="st">"Parameter estimate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">10</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="whyInitVals_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">parameters2</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, x <span class="op">=</span> <span class="va">simInitVals</span>, main <span class="op">=</span> <span class="st">"Estimates for the st.dev."</span>, xlab <span class="op">=</span> <span class="st">"Simulated init. vals."</span>, ylab <span class="op">=</span> <span class="st">"Parameter estimate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="whyInitVals_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<p>Here we see a very interesting result: The initial values near zero
up to a bit above 1 cause very odd and unreliable estimates of each
parameter, while larger values, closer to the real parameter values
invariantly provide reliable estimates. Please note that the red line is
the true parameter value that we started with above. But, what happens
in the neighborhood of the mean of the quantiles?</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meanNeighbors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">simInitVals</span> <span class="op">&gt;</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">simInitVals</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">simInitVals</span> <span class="op">&lt;</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">simInitVals</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">parameters2</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">[</span><span class="va">meanNeighbors</span><span class="op">]</span>, x <span class="op">=</span> <span class="va">simInitVals</span><span class="op">[</span><span class="va">meanNeighbors</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"Neighbors of mean(quantiles)"</span>, xlab <span class="op">=</span> <span class="st">"Simulated init. vals."</span>, ylab <span class="op">=</span> <span class="st">"Parameter estimate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">10</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="whyInitVals_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">parameters2</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">[</span><span class="va">meanNeighbors</span><span class="op">]</span>, x <span class="op">=</span> <span class="va">simInitVals</span><span class="op">[</span><span class="va">meanNeighbors</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"Neighbors of mean(quantiles)"</span>, xlab <span class="op">=</span> <span class="st">"Simulated init. vals."</span>, ylab <span class="op">=</span> <span class="st">"Parameter estimate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="whyInitVals_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<p>Now letâ€™s visualize it as densities:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">parameters2</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">[</span><span class="va">meanNeighbors</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Neighbors of mean(quantiles)"</span>, ylab <span class="op">=</span> <span class="st">"Parameter estimate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">10</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="whyInitVals_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">parameters2</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">[</span><span class="va">meanNeighbors</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Neighbors of mean(quantiles)"</span>, ylab <span class="op">=</span> <span class="st">"Parameter estimate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="whyInitVals_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<p>Here we see that the values around the mean of the quantiles as
initial values behave with the regular properties of large-number theory
(real parameter number in red line as above). Therefore, it is advisable
to pick this as a regular initial value in the context of the
<code>optmi</code> function.</p>
<p>Why did the first example behave nicely? Results not shown (just
change the values in <code>seq(from = 0, to = 1)</code>) indicate that
convergence is not a concern when estimating the parameters in the beta
distribution and there is a reason for it. The beta PDF is defined over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math>,
so it makes no sense at all to try values outside this interval:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î±</mi><mo>,</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="prefix">|</mo><mi>Î±</mi><mo>,</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msup><mi>x</mi><mrow><mi>Î±</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>Î²</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î±</mi><mo>,</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">Beta(\alpha,\beta):\,\, P(x|\alpha,\beta)=\frac{x^{\alpha-1}(1-x)^{\beta-1}}{B(\alpha,\beta)}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
is the beta function</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î±</mi><mo>,</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>âˆ«</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>t</mi><mrow><mi>Î±</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>Î²</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">B(\alpha,\beta)=\int_{0}^{1}t^{\alpha-1}(1-t)^{\beta-1}dt</annotation></semantics></math></p>
<p>Being 0 and 1 not that far away from each other, we find they
behaving as our simulation of the neighborhood of the mean of quantiles
in the esitmation of the normal PDF parameters.</p>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gustavo A. Ballen, Sandra Reinales.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
